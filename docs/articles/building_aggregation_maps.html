<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="PFUDatabase">
<title>Building Aggregation Maps From Row and Column Labels • PFUDatabase</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Building Aggregation Maps From Row and Column Labels">
<meta property="og:description" content="PFUDatabase">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PFUDatabase</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/PFUDatabase_Demo.html">PFUDatabase Demo</a>
    <a class="dropdown-item" href="../articles/building_aggregation_maps.html">Building Aggregation Maps From Row and Column Labels</a>
    <a class="dropdown-item" href="../articles/following_a_product.html">Following a Product Through an Energy Conversion Chain</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Building Aggregation Maps From Row and Column Labels</h1>
            
      
      
      <div class="d-none name"><code>building_aggregation_maps.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Aggregation maps are helpful when aggregating products and industries
in rows and columns of PSUT matrices (<strong>R</strong>,
<strong>U</strong>, <strong>V</strong>, and <strong>Y</strong>). This
vignette demonstrates ways to use row and column names from PSUT
matrices to create an aggregation map.</p>
<p>To provide an example, this vignette uses data from one of the CL-PFU
Database products, namely the product named “psut” from v0.9 of the
database, which is a <code>matsindf</code> data frame containing PSUT
matrices for the USA, 1960–2019.</p>
</div>
<div class="section level2">
<h2 id="load-psut-data">Load PSUT data<a class="anchor" aria-label="anchor" href="#load-psut-data"></a>
</h2>
<p>To work with the CL-PFU database as shown in this vignette, be sure
you have access to several packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MatthewHeun/matsbyname" class="external-link">matsbyname</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pins.rstudio.com/" class="external-link">pins</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MatthewHeun/Recca" class="external-link">Recca</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org" class="external-link">readxl</a></span><span class="op">)</span></span></code></pre></div>
<p>To load the data, use code like this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pinboard</span> <span class="op">&lt;-</span> <span class="fu">pins</span><span class="fu">::</span><span class="fu"><a href="https://pins.rstudio.com/reference/board_folder.html" class="external-link">board_folder</a></span><span class="op">(</span><span class="st">"~/Dropbox/Fellowship 1960-2015 PFU database/OutputData/PipelineReleases"</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">pinboard</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Load USA data from v0.9 of the database</span></span>
<span>  <span class="fu">pins</span><span class="fu">::</span><span class="fu"><a href="https://pins.rstudio.com/reference/pin_read.html" class="external-link">pin_read</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"psut_usa"</span>, version <span class="op">=</span> <span class="st">"20230220T223535Z-35e3e"</span><span class="op">)</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 720</span></span>
<span><span class="co">#&gt; Columns: 14</span></span>
<span><span class="co">#&gt; $ Country     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "USA", "USA", "USA", "USA", "USA", "USA", "USA", "USA", "U…</span></span>
<span><span class="co">#&gt; $ Method      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "P…</span></span>
<span><span class="co">#&gt; $ Energy.type <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E"…</span></span>
<span><span class="co">#&gt; $ Last.stage  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final", "Final", "Final", "Final", "Final", "Fin…</span></span>
<span><span class="co">#&gt; $ Year        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1960, 1961, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 1969…</span></span>
<span><span class="co">#&gt; $ IEAMW       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "IEA", "IEA", "IEA", "IEA", "IEA", "IEA", "IEA", "IEA", "I…</span></span>
<span><span class="co">#&gt; $ Y           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[24 x 43]&gt;&gt;, &lt;&lt;matrix[24 x 47]&gt;&gt;, &lt;&lt;matrix[24 x 4…</span></span>
<span><span class="co">#&gt; $ S_units     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[36 x 1]&gt;&gt;, &lt;&lt;matrix[36 x 1]&gt;&gt;, &lt;&lt;matrix[36 x 1]&gt;…</span></span>
<span><span class="co">#&gt; $ R           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[33 x 26]&gt;&gt;, &lt;&lt;matrix[27 x 24]&gt;&gt;, &lt;&lt;matrix[28 x 2…</span></span>
<span><span class="co">#&gt; $ U           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[26 x 15]&gt;&gt;, &lt;&lt;matrix[26 x 15]&gt;&gt;, &lt;&lt;matrix[26 x 1…</span></span>
<span><span class="co">#&gt; $ U_feed      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[21 x 15]&gt;&gt;, &lt;&lt;matrix[21 x 15]&gt;&gt;, &lt;&lt;matrix[21 x 1…</span></span>
<span><span class="co">#&gt; $ U_EIOU      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[8 x 6]&gt;&gt;, &lt;&lt;matrix[8 x 6]&gt;&gt;, &lt;&lt;matrix[8 x 6]&gt;&gt;, …</span></span>
<span><span class="co">#&gt; $ r_EIOU      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[26 x 15]&gt;&gt;, &lt;&lt;matrix[26 x 15]&gt;&gt;, &lt;&lt;matrix[26 x 1…</span></span>
<span><span class="co">#&gt; $ V           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[15 x 28]&gt;&gt;, &lt;&lt;matrix[15 x 28]&gt;&gt;, &lt;&lt;matrix[15 x 2…</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="extract-row-and-column-names">Extract row and column names<a class="anchor" aria-label="anchor" href="#extract-row-and-column-names"></a>
</h2>
<p><code><a href="https://matthewheun.github.io/Recca/reference/get_all_products_and_industries.html" class="external-link">Recca::get_all_products_and_industries()</a></code> will find the
product and industry names for each row of the matsindf data frame. The
results are placed in two new columns of the data frame named (by
default) “Product.names” and “Industry.names”.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_with_prods_inds</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">Recca</span><span class="fu">::</span><span class="fu"><a href="https://matthewheun.github.io/Recca/reference/get_all_products_and_industries.html" class="external-link">get_all_products_and_industries</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">df_with_prods_inds</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 720</span></span>
<span><span class="co">#&gt; Columns: 16</span></span>
<span><span class="co">#&gt; $ Country        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "USA", "USA", "USA", "USA", "USA", "USA", "USA", "USA",…</span></span>
<span><span class="co">#&gt; $ Method         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM",…</span></span>
<span><span class="co">#&gt; $ Energy.type    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", …</span></span>
<span><span class="co">#&gt; $ Last.stage     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final", "Final", "Final", "Final", "Final", "…</span></span>
<span><span class="co">#&gt; $ Year           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1960, 1961, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 1…</span></span>
<span><span class="co">#&gt; $ IEAMW          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "IEA", "IEA", "IEA", "IEA", "IEA", "IEA", "IEA", "IEA",…</span></span>
<span><span class="co">#&gt; $ Y              <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[24 x 43]&gt;&gt;, &lt;&lt;matrix[24 x 47]&gt;&gt;, &lt;&lt;matrix[24 …</span></span>
<span><span class="co">#&gt; $ S_units        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[36 x 1]&gt;&gt;, &lt;&lt;matrix[36 x 1]&gt;&gt;, &lt;&lt;matrix[36 x …</span></span>
<span><span class="co">#&gt; $ R              <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[33 x 26]&gt;&gt;, &lt;&lt;matrix[27 x 24]&gt;&gt;, &lt;&lt;matrix[28 …</span></span>
<span><span class="co">#&gt; $ U              <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[26 x 15]&gt;&gt;, &lt;&lt;matrix[26 x 15]&gt;&gt;, &lt;&lt;matrix[26 …</span></span>
<span><span class="co">#&gt; $ U_feed         <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[21 x 15]&gt;&gt;, &lt;&lt;matrix[21 x 15]&gt;&gt;, &lt;&lt;matrix[21 …</span></span>
<span><span class="co">#&gt; $ U_EIOU         <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[8 x 6]&gt;&gt;, &lt;&lt;matrix[8 x 6]&gt;&gt;, &lt;&lt;matrix[8 x 6]&gt;…</span></span>
<span><span class="co">#&gt; $ r_EIOU         <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[26 x 15]&gt;&gt;, &lt;&lt;matrix[26 x 15]&gt;&gt;, &lt;&lt;matrix[26 …</span></span>
<span><span class="co">#&gt; $ V              <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[15 x 28]&gt;&gt;, &lt;&lt;matrix[15 x 28]&gt;&gt;, &lt;&lt;matrix[15 …</span></span>
<span><span class="co">#&gt; $ Product.names  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;"Bitumen", "Brown coal (if no detail) [from Resources…</span></span>
<span><span class="co">#&gt; $ Industry.names <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;"Imports [of Bitumen]", "Imports [of Coke oven coke]"…</span></span></code></pre></div>
<p>Product and industry names can be quite different from row to row in
the data frame, because there are many new energy carriers (products)
when the Last.stage is “Useful” compared to “Final”.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check a row with "Final" energy as the Last.stage.</span></span>
<span><span class="va">df_with_prods_inds</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Energy.type</span> <span class="op">==</span> <span class="st">"E"</span>, </span>
<span>                <span class="va">Last.stage</span> <span class="op">==</span> <span class="st">"Final"</span>, </span>
<span>                <span class="va">Year</span> <span class="op">==</span> <span class="fl">1960</span>, </span>
<span>                <span class="va">IEAMW</span> <span class="op">==</span> <span class="st">"IEA"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">extract2</a></span><span class="op">(</span><span class="st">"Product.names"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;  [1] "Bitumen"                                                  </span></span>
<span><span class="co">#&gt;  [2] "Brown coal (if no detail) [from Resources]"               </span></span>
<span><span class="co">#&gt;  [3] "Coke oven coke"                                           </span></span>
<span><span class="co">#&gt;  [4] "Crude/NGL/feedstocks (if no detail)"                      </span></span>
<span><span class="co">#&gt;  [5] "Crude/NGL/feedstocks (if no detail) [from Resources]"     </span></span>
<span><span class="co">#&gt;  [6] "Electricity"                                              </span></span>
<span><span class="co">#&gt;  [7] "Fuel oil"                                                 </span></span>
<span><span class="co">#&gt;  [8] "Gas/diesel oil excl. biofuels"                            </span></span>
<span><span class="co">#&gt;  [9] "Geothermal [from Resources]"                              </span></span>
<span><span class="co">#&gt; [10] "Hard coal (if no detail)"                                 </span></span>
<span><span class="co">#&gt; [11] "Hard coal (if no detail) [from Resources]"                </span></span>
<span><span class="co">#&gt; [12] "Hydro [from Resources]"                                   </span></span>
<span><span class="co">#&gt; [13] "Kerosene type jet fuel excl. biofuels"                    </span></span>
<span><span class="co">#&gt; [14] "Liquefied petroleum gases (LPG)"                          </span></span>
<span><span class="co">#&gt; [15] "Lubricants"                                               </span></span>
<span><span class="co">#&gt; [16] "Motor gasoline excl. biofuels"                            </span></span>
<span><span class="co">#&gt; [17] "Natural gas"                                              </span></span>
<span><span class="co">#&gt; [18] "Natural gas [from Resources]"                             </span></span>
<span><span class="co">#&gt; [19] "Non-specified primary biofuels and waste"                 </span></span>
<span><span class="co">#&gt; [20] "Non-specified primary biofuels and waste [from Resources]"</span></span>
<span><span class="co">#&gt; [21] "Nuclear [from Resources]"                                 </span></span>
<span><span class="co">#&gt; [22] "Other kerosene"                                           </span></span>
<span><span class="co">#&gt; [23] "Other oil products"                                       </span></span>
<span><span class="co">#&gt; [24] "Paraffin waxes"                                           </span></span>
<span><span class="co">#&gt; [25] "Patent fuel"                                              </span></span>
<span><span class="co">#&gt; [26] "Petroleum coke"                                           </span></span>
<span><span class="co">#&gt; [27] "Blast furnace gas"                                        </span></span>
<span><span class="co">#&gt; [28] "Brown coal (if no detail)"                                </span></span>
<span><span class="co">#&gt; [29] "Coke oven gas"                                            </span></span>
<span><span class="co">#&gt; [30] "Gas coke"                                                 </span></span>
<span><span class="co">#&gt; [31] "Gas works gas"                                            </span></span>
<span><span class="co">#&gt; [32] "Geothermal"                                               </span></span>
<span><span class="co">#&gt; [33] "Hydro"                                                    </span></span>
<span><span class="co">#&gt; [34] "Nuclear"                                                  </span></span>
<span><span class="co">#&gt; [35] "Refinery gas"                                             </span></span>
<span><span class="co">#&gt; [36] "Aviation gasoline"</span></span>
<span></span>
<span><span class="co"># Check a row with "Useful" energy as the Last.stage.</span></span>
<span><span class="va">df_with_prods_inds</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Energy.type</span> <span class="op">==</span> <span class="st">"E"</span>, </span>
<span>                <span class="va">Last.stage</span> <span class="op">==</span> <span class="st">"Useful"</span>, </span>
<span>                <span class="va">Year</span> <span class="op">==</span> <span class="fl">1960</span>, </span>
<span>                <span class="va">IEAMW</span> <span class="op">==</span> <span class="st">"IEA"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">extract2</a></span><span class="op">(</span><span class="st">"Product.names"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;  [1] "Bitumen"                                                  </span></span>
<span><span class="co">#&gt;  [2] "Brown coal (if no detail) [from Resources]"               </span></span>
<span><span class="co">#&gt;  [3] "Coke oven coke"                                           </span></span>
<span><span class="co">#&gt;  [4] "Crude/NGL/feedstocks (if no detail)"                      </span></span>
<span><span class="co">#&gt;  [5] "Crude/NGL/feedstocks (if no detail) [from Resources]"     </span></span>
<span><span class="co">#&gt;  [6] "Electricity"                                              </span></span>
<span><span class="co">#&gt;  [7] "Fuel oil"                                                 </span></span>
<span><span class="co">#&gt;  [8] "Gas/diesel oil excl. biofuels"                            </span></span>
<span><span class="co">#&gt;  [9] "Geothermal [from Resources]"                              </span></span>
<span><span class="co">#&gt; [10] "Hard coal (if no detail)"                                 </span></span>
<span><span class="co">#&gt; [11] "Hard coal (if no detail) [from Resources]"                </span></span>
<span><span class="co">#&gt; [12] "Hydro [from Resources]"                                   </span></span>
<span><span class="co">#&gt; [13] "Kerosene type jet fuel excl. biofuels"                    </span></span>
<span><span class="co">#&gt; [14] "Liquefied petroleum gases (LPG)"                          </span></span>
<span><span class="co">#&gt; [15] "Lubricants"                                               </span></span>
<span><span class="co">#&gt; [16] "Motor gasoline excl. biofuels"                            </span></span>
<span><span class="co">#&gt; [17] "Natural gas"                                              </span></span>
<span><span class="co">#&gt; [18] "Natural gas [from Resources]"                             </span></span>
<span><span class="co">#&gt; [19] "Non-specified primary biofuels and waste"                 </span></span>
<span><span class="co">#&gt; [20] "Non-specified primary biofuels and waste [from Resources]"</span></span>
<span><span class="co">#&gt; [21] "Nuclear [from Resources]"                                 </span></span>
<span><span class="co">#&gt; [22] "Other kerosene"                                           </span></span>
<span><span class="co">#&gt; [23] "Other oil products"                                       </span></span>
<span><span class="co">#&gt; [24] "Paraffin waxes"                                           </span></span>
<span><span class="co">#&gt; [25] "Patent fuel"                                              </span></span>
<span><span class="co">#&gt; [26] "Petroleum coke"                                           </span></span>
<span><span class="co">#&gt; [27] "Aviation gasoline"                                        </span></span>
<span><span class="co">#&gt; [28] "Blast furnace gas"                                        </span></span>
<span><span class="co">#&gt; [29] "Brown coal (if no detail)"                                </span></span>
<span><span class="co">#&gt; [30] "Coke oven gas"                                            </span></span>
<span><span class="co">#&gt; [31] "Gas coke"                                                 </span></span>
<span><span class="co">#&gt; [32] "Gas works gas"                                            </span></span>
<span><span class="co">#&gt; [33] "Geothermal"                                               </span></span>
<span><span class="co">#&gt; [34] "HPA [from Air compressors]"                               </span></span>
<span><span class="co">#&gt; [35] "HPL [from Electric pumps]"                                </span></span>
<span><span class="co">#&gt; [36] "HPL [from Gas pump jacks]"                                </span></span>
<span><span class="co">#&gt; [37] "HTH.1600.C [from Blast oxygen furnaces]"                  </span></span>
<span><span class="co">#&gt; [38] "HTH.600.C [from Industrial electric process heaters]"     </span></span>
<span><span class="co">#&gt; [39] "HTH.850.C [from Steam cracking furnaces]"                 </span></span>
<span><span class="co">#&gt; [40] "HTH.960.C [from Electro-chemical processors]"             </span></span>
<span><span class="co">#&gt; [41] "Hydro"                                                    </span></span>
<span><span class="co">#&gt; [42] "IP [from Computers]"                                      </span></span>
<span><span class="co">#&gt; [43] "KE [from Industrial fans]"                                </span></span>
<span><span class="co">#&gt; [44] "L [from Industrial electric lamps]"                       </span></span>
<span><span class="co">#&gt; [45] "LTC.-10.C [from Industrial refrigerators]"                </span></span>
<span><span class="co">#&gt; [46] "LTC.20.C [from HVAC]"                                     </span></span>
<span><span class="co">#&gt; [47] "LTH.20.C [from Gas space heaters]"                        </span></span>
<span><span class="co">#&gt; [48] "MacW [from Machine tools]"                                </span></span>
<span><span class="co">#&gt; [49] "MacW [from Material handlers]"                            </span></span>
<span><span class="co">#&gt; [50] "MTH.100.C [from Gas water heaters]"                       </span></span>
<span><span class="co">#&gt; [51] "Nuclear"                                                  </span></span>
<span><span class="co">#&gt; [52] "Refinery gas"                                             </span></span>
<span><span class="co">#&gt; [53] "RoP [from Electric cars]"                                 </span></span>
<span><span class="co">#&gt; [54] "AirP [from Domestic aircraft]"                            </span></span>
<span><span class="co">#&gt; [55] "HTH.1300.C [from Small scale biomass boilers]"            </span></span>
<span><span class="co">#&gt; [56] "HTH.1600.C [from Electric arc furnaces]"                  </span></span>
<span><span class="co">#&gt; [57] "L [from Commercial indoor electric lamps]"                </span></span>
<span><span class="co">#&gt; [58] "L [from Commercial outdoor electric lamps]"               </span></span>
<span><span class="co">#&gt; [59] "L [from Domestic electric lamps]"                         </span></span>
<span><span class="co">#&gt; [60] "LTC.-10.C [from Refrigerators]"                           </span></span>
<span><span class="co">#&gt; [61] "LTC.20.C [from Room air conditioners]"                    </span></span>
<span><span class="co">#&gt; [62] "LTH.20.C [from Coal stoves]"                              </span></span>
<span><span class="co">#&gt; [63] "LTH.20.C [from Electric space heaters]"                   </span></span>
<span><span class="co">#&gt; [64] "LTH.20.C [from LPG stoves]"                               </span></span>
<span><span class="co">#&gt; [65] "LTH.20.C [from Oil space heaters]"                        </span></span>
<span><span class="co">#&gt; [66] "LTH.50.C [from Coal stoves]"                              </span></span>
<span><span class="co">#&gt; [67] "LTH.50.C [from LPG stoves]"                               </span></span>
<span><span class="co">#&gt; [68] "MacW [from Tractors]"                                     </span></span>
<span><span class="co">#&gt; [69] "MaP [from Domestic boats]"                                </span></span>
<span><span class="co">#&gt; [70] "MD [from Domestic appliances]"                            </span></span>
<span><span class="co">#&gt; [71] "MD [from Static diesel engines]"                          </span></span>
<span><span class="co">#&gt; [72] "MD [from Static gasoline engines]"                        </span></span>
<span><span class="co">#&gt; [73] "MTH.100.C [from Coal stoves]"                             </span></span>
<span><span class="co">#&gt; [74] "MTH.100.C [from Electric water heaters]"                  </span></span>
<span><span class="co">#&gt; [75] "MTH.100.C [from Kerosene stoves]"                         </span></span>
<span><span class="co">#&gt; [76] "MTH.100.C [from LPG stoves]"                              </span></span>
<span><span class="co">#&gt; [77] "MTH.100.C [from Oil water heaters]"                       </span></span>
<span><span class="co">#&gt; [78] "MTH.100.C [from Wood stoves]"                             </span></span>
<span><span class="co">#&gt; [79] "MTH.200.C [from Coal stoves]"                             </span></span>
<span><span class="co">#&gt; [80] "MTH.200.C [from Commercial electric ovens]"               </span></span>
<span><span class="co">#&gt; [81] "MTH.200.C [from Commercial gas ovens]"                    </span></span>
<span><span class="co">#&gt; [82] "MTH.200.C [from Domestic electric ovens]"                 </span></span>
<span><span class="co">#&gt; [83] "MTH.200.C [from Domestic gas ovens]"                      </span></span>
<span><span class="co">#&gt; [84] "NEU [from Non-energy consumption]"                        </span></span>
<span><span class="co">#&gt; [85] "RaP [from Diesel trains]"                                 </span></span>
<span><span class="co">#&gt; [86] "RaP [from Electric trains]"                               </span></span>
<span><span class="co">#&gt; [87] "RaP [from Steam trains]"                                  </span></span>
<span><span class="co">#&gt; [88] "RoP [from Diesel HDVs]"                                   </span></span>
<span><span class="co">#&gt; [89] "RoP [from Gasoline LDVs]"                                 </span></span>
<span><span class="co">#&gt; [90] "RoP [from Gasoline motorcycles]"                          </span></span>
<span><span class="co">#&gt; [91] "RoP [from Natural gas vehicles]"</span></span></code></pre></div>
<p>Similarly, industry names may be quite different when Last.stage is
“Final” or “Useful”.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check a row with "Final" energy as the Last.stage.</span></span>
<span><span class="va">df_with_prods_inds</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Energy.type</span> <span class="op">==</span> <span class="st">"E"</span>, </span>
<span>                <span class="va">Last.stage</span> <span class="op">==</span> <span class="st">"Final"</span>, </span>
<span>                <span class="va">Year</span> <span class="op">==</span> <span class="fl">1960</span>, </span>
<span>                <span class="va">IEAMW</span> <span class="op">==</span> <span class="st">"IEA"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">extract2</a></span><span class="op">(</span><span class="st">"Industry.names"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Imports [of Bitumen]"                                              </span></span>
<span><span class="co">#&gt;  [2] "Imports [of Coke oven coke]"                                       </span></span>
<span><span class="co">#&gt;  [3] "Imports [of Crude/NGL/feedstocks]"                                 </span></span>
<span><span class="co">#&gt;  [4] "Imports [of Electricity]"                                          </span></span>
<span><span class="co">#&gt;  [5] "Imports [of Fuel oil]"                                             </span></span>
<span><span class="co">#&gt;  [6] "Imports [of Gas/diesel oil excl]"                                  </span></span>
<span><span class="co">#&gt;  [7] "Imports [of Hard coal]"                                            </span></span>
<span><span class="co">#&gt;  [8] "Imports [of Kerosene type jet fuel excl]"                          </span></span>
<span><span class="co">#&gt;  [9] "Imports [of Liquefied petroleum gases]"                            </span></span>
<span><span class="co">#&gt; [10] "Imports [of Lubricants]"                                           </span></span>
<span><span class="co">#&gt; [11] "Imports [of Motor gasoline excl]"                                  </span></span>
<span><span class="co">#&gt; [12] "Imports [of Natural gas]"                                          </span></span>
<span><span class="co">#&gt; [13] "Imports [of Other kerosene]"                                       </span></span>
<span><span class="co">#&gt; [14] "Imports [of Other oil products]"                                   </span></span>
<span><span class="co">#&gt; [15] "Imports [of Paraffin waxes]"                                       </span></span>
<span><span class="co">#&gt; [16] "Imports [of Patent fuel]"                                          </span></span>
<span><span class="co">#&gt; [17] "Resources [of Brown coal (if no detail)]"                          </span></span>
<span><span class="co">#&gt; [18] "Resources [of Crude/NGL/feedstocks (if no detail)]"                </span></span>
<span><span class="co">#&gt; [19] "Resources [of Geothermal]"                                         </span></span>
<span><span class="co">#&gt; [20] "Resources [of Hard coal (if no detail)]"                           </span></span>
<span><span class="co">#&gt; [21] "Resources [of Hydro]"                                              </span></span>
<span><span class="co">#&gt; [22] "Resources [of Natural gas]"                                        </span></span>
<span><span class="co">#&gt; [23] "Resources [of Non-specified primary biofuels and waste]"           </span></span>
<span><span class="co">#&gt; [24] "Resources [of Nuclear]"                                            </span></span>
<span><span class="co">#&gt; [25] "Statistical differences"                                           </span></span>
<span><span class="co">#&gt; [26] "Stock changes [of Bitumen]"                                        </span></span>
<span><span class="co">#&gt; [27] "Stock changes [of Crude/NGL/feedstocks]"                           </span></span>
<span><span class="co">#&gt; [28] "Stock changes [of Fuel oil]"                                       </span></span>
<span><span class="co">#&gt; [29] "Stock changes [of Gas/diesel oil excl]"                            </span></span>
<span><span class="co">#&gt; [30] "Stock changes [of Hard coal]"                                      </span></span>
<span><span class="co">#&gt; [31] "Stock changes [of Kerosene type jet fuel excl]"                    </span></span>
<span><span class="co">#&gt; [32] "Stock changes [of Other oil products]"                             </span></span>
<span><span class="co">#&gt; [33] "Stock changes [of Petroleum coke]"                                 </span></span>
<span><span class="co">#&gt; [34] "Blast furnaces"                                                    </span></span>
<span><span class="co">#&gt; [35] "Coal mines"                                                        </span></span>
<span><span class="co">#&gt; [36] "Coke ovens"                                                        </span></span>
<span><span class="co">#&gt; [37] "Gas works"                                                         </span></span>
<span><span class="co">#&gt; [38] "Main activity producer electricity plants"                         </span></span>
<span><span class="co">#&gt; [39] "Manufacture [of Geothermal]"                                       </span></span>
<span><span class="co">#&gt; [40] "Manufacture [of Hydro]"                                            </span></span>
<span><span class="co">#&gt; [41] "Manufacture [of Non-specified primary biofuels and waste]"         </span></span>
<span><span class="co">#&gt; [42] "Manufacture [of Nuclear]"                                          </span></span>
<span><span class="co">#&gt; [43] "Natural gas extraction"                                            </span></span>
<span><span class="co">#&gt; [44] "Nuclear industry"                                                  </span></span>
<span><span class="co">#&gt; [45] "Oil extraction"                                                    </span></span>
<span><span class="co">#&gt; [46] "Oil refineries"                                                    </span></span>
<span><span class="co">#&gt; [47] "Patent fuel plants"                                                </span></span>
<span><span class="co">#&gt; [48] "Transfers"                                                         </span></span>
<span><span class="co">#&gt; [49] "Agriculture/forestry"                                              </span></span>
<span><span class="co">#&gt; [50] "Chemical and petrochemical"                                        </span></span>
<span><span class="co">#&gt; [51] "Commercial and public services"                                    </span></span>
<span><span class="co">#&gt; [52] "Domestic aviation"                                                 </span></span>
<span><span class="co">#&gt; [53] "Domestic navigation"                                               </span></span>
<span><span class="co">#&gt; [54] "Exports [of Bitumen]"                                              </span></span>
<span><span class="co">#&gt; [55] "Exports [of Coke oven coke]"                                       </span></span>
<span><span class="co">#&gt; [56] "Exports [of Crude/NGL/feedstocks]"                                 </span></span>
<span><span class="co">#&gt; [57] "Exports [of Electricity]"                                          </span></span>
<span><span class="co">#&gt; [58] "Exports [of Fuel oil]"                                             </span></span>
<span><span class="co">#&gt; [59] "Exports [of Gas/diesel oil excl]"                                  </span></span>
<span><span class="co">#&gt; [60] "Exports [of Hard coal]"                                            </span></span>
<span><span class="co">#&gt; [61] "Exports [of Kerosene type jet fuel excl]"                          </span></span>
<span><span class="co">#&gt; [62] "Exports [of Liquefied petroleum gases]"                            </span></span>
<span><span class="co">#&gt; [63] "Exports [of Lubricants]"                                           </span></span>
<span><span class="co">#&gt; [64] "Exports [of Motor gasoline excl]"                                  </span></span>
<span><span class="co">#&gt; [65] "Exports [of Natural gas]"                                          </span></span>
<span><span class="co">#&gt; [66] "Exports [of Other kerosene]"                                       </span></span>
<span><span class="co">#&gt; [67] "Exports [of Other oil products]"                                   </span></span>
<span><span class="co">#&gt; [68] "Exports [of Paraffin waxes]"                                       </span></span>
<span><span class="co">#&gt; [69] "Exports [of Patent fuel]"                                          </span></span>
<span><span class="co">#&gt; [70] "Exports [of Petroleum coke]"                                       </span></span>
<span><span class="co">#&gt; [71] "Exports to World aviation bunkers [of Kerosene type jet fuel excl]"</span></span>
<span><span class="co">#&gt; [72] "Exports to World marine bunkers [of Fuel oil]"                     </span></span>
<span><span class="co">#&gt; [73] "Exports to World marine bunkers [of Gas/diesel oil excl]"          </span></span>
<span><span class="co">#&gt; [74] "Exports to World marine bunkers [of Hard coal]"                    </span></span>
<span><span class="co">#&gt; [75] "Final consumption not elsewhere specified"                         </span></span>
<span><span class="co">#&gt; [76] "Industry not elsewhere specified"                                  </span></span>
<span><span class="co">#&gt; [77] "Iron and steel"                                                    </span></span>
<span><span class="co">#&gt; [78] "Losses"                                                            </span></span>
<span><span class="co">#&gt; [79] "Non-energy use in transport"                                       </span></span>
<span><span class="co">#&gt; [80] "Non-energy use industry/transformation/energy"                     </span></span>
<span><span class="co">#&gt; [81] "Rail"                                                              </span></span>
<span><span class="co">#&gt; [82] "Residential"                                                       </span></span>
<span><span class="co">#&gt; [83] "Road"                                                              </span></span>
<span><span class="co">#&gt; [84] "Stock changes [of Coke oven coke]"                                 </span></span>
<span><span class="co">#&gt; [85] "Stock changes [of Liquefied petroleum gases]"                      </span></span>
<span><span class="co">#&gt; [86] "Stock changes [of Lubricants]"                                     </span></span>
<span><span class="co">#&gt; [87] "Stock changes [of Motor gasoline excl]"                            </span></span>
<span><span class="co">#&gt; [88] "Stock changes [of Natural gas]"                                    </span></span>
<span><span class="co">#&gt; [89] "Stock changes [of Other kerosene]"                                 </span></span>
<span><span class="co">#&gt; [90] "Stock changes [of Paraffin waxes]"</span></span>
<span></span>
<span><span class="co"># Check a row with "Useful" energy as the Last.stage.</span></span>
<span><span class="va">df_with_prods_inds</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Energy.type</span> <span class="op">==</span> <span class="st">"E"</span>, </span>
<span>                <span class="va">Last.stage</span> <span class="op">==</span> <span class="st">"Useful"</span>, </span>
<span>                <span class="va">Year</span> <span class="op">==</span> <span class="fl">1960</span>, </span>
<span>                <span class="va">IEAMW</span> <span class="op">==</span> <span class="st">"IEA"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">extract2</a></span><span class="op">(</span><span class="st">"Industry.names"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   [1] "Imports [of Bitumen]"                                              </span></span>
<span><span class="co">#&gt;   [2] "Imports [of Coke oven coke]"                                       </span></span>
<span><span class="co">#&gt;   [3] "Imports [of Crude/NGL/feedstocks]"                                 </span></span>
<span><span class="co">#&gt;   [4] "Imports [of Electricity]"                                          </span></span>
<span><span class="co">#&gt;   [5] "Imports [of Fuel oil]"                                             </span></span>
<span><span class="co">#&gt;   [6] "Imports [of Gas/diesel oil excl]"                                  </span></span>
<span><span class="co">#&gt;   [7] "Imports [of Hard coal]"                                            </span></span>
<span><span class="co">#&gt;   [8] "Imports [of Kerosene type jet fuel excl]"                          </span></span>
<span><span class="co">#&gt;   [9] "Imports [of Liquefied petroleum gases]"                            </span></span>
<span><span class="co">#&gt;  [10] "Imports [of Lubricants]"                                           </span></span>
<span><span class="co">#&gt;  [11] "Imports [of Motor gasoline excl]"                                  </span></span>
<span><span class="co">#&gt;  [12] "Imports [of Natural gas]"                                          </span></span>
<span><span class="co">#&gt;  [13] "Imports [of Other kerosene]"                                       </span></span>
<span><span class="co">#&gt;  [14] "Imports [of Other oil products]"                                   </span></span>
<span><span class="co">#&gt;  [15] "Imports [of Paraffin waxes]"                                       </span></span>
<span><span class="co">#&gt;  [16] "Imports [of Patent fuel]"                                          </span></span>
<span><span class="co">#&gt;  [17] "Resources [of Brown coal (if no detail)]"                          </span></span>
<span><span class="co">#&gt;  [18] "Resources [of Crude/NGL/feedstocks (if no detail)]"                </span></span>
<span><span class="co">#&gt;  [19] "Resources [of Geothermal]"                                         </span></span>
<span><span class="co">#&gt;  [20] "Resources [of Hard coal (if no detail)]"                           </span></span>
<span><span class="co">#&gt;  [21] "Resources [of Hydro]"                                              </span></span>
<span><span class="co">#&gt;  [22] "Resources [of Natural gas]"                                        </span></span>
<span><span class="co">#&gt;  [23] "Resources [of Non-specified primary biofuels and waste]"           </span></span>
<span><span class="co">#&gt;  [24] "Resources [of Nuclear]"                                            </span></span>
<span><span class="co">#&gt;  [25] "Statistical differences"                                           </span></span>
<span><span class="co">#&gt;  [26] "Stock changes [of Bitumen]"                                        </span></span>
<span><span class="co">#&gt;  [27] "Stock changes [of Crude/NGL/feedstocks]"                           </span></span>
<span><span class="co">#&gt;  [28] "Stock changes [of Fuel oil]"                                       </span></span>
<span><span class="co">#&gt;  [29] "Stock changes [of Gas/diesel oil excl]"                            </span></span>
<span><span class="co">#&gt;  [30] "Stock changes [of Hard coal]"                                      </span></span>
<span><span class="co">#&gt;  [31] "Stock changes [of Kerosene type jet fuel excl]"                    </span></span>
<span><span class="co">#&gt;  [32] "Stock changes [of Other oil products]"                             </span></span>
<span><span class="co">#&gt;  [33] "Stock changes [of Petroleum coke]"                                 </span></span>
<span><span class="co">#&gt;  [34] "Air compressors -&gt; HPA"                                            </span></span>
<span><span class="co">#&gt;  [35] "Blast furnaces"                                                    </span></span>
<span><span class="co">#&gt;  [36] "Blast oxygen furnaces -&gt; HTH.1600.C"                               </span></span>
<span><span class="co">#&gt;  [37] "Coal mines"                                                        </span></span>
<span><span class="co">#&gt;  [38] "Coal stoves -&gt; LTH.20.C"                                           </span></span>
<span><span class="co">#&gt;  [39] "Coal stoves -&gt; LTH.50.C"                                           </span></span>
<span><span class="co">#&gt;  [40] "Coal stoves -&gt; MTH.100.C"                                          </span></span>
<span><span class="co">#&gt;  [41] "Coal stoves -&gt; MTH.200.C"                                          </span></span>
<span><span class="co">#&gt;  [42] "Coke ovens"                                                        </span></span>
<span><span class="co">#&gt;  [43] "Commercial electric ovens -&gt; MTH.200.C"                            </span></span>
<span><span class="co">#&gt;  [44] "Commercial gas ovens -&gt; MTH.200.C"                                 </span></span>
<span><span class="co">#&gt;  [45] "Commercial indoor electric lamps -&gt; L"                             </span></span>
<span><span class="co">#&gt;  [46] "Commercial outdoor electric lamps -&gt; L"                            </span></span>
<span><span class="co">#&gt;  [47] "Computers -&gt; IP"                                                   </span></span>
<span><span class="co">#&gt;  [48] "Diesel HDVs -&gt; RoP"                                                </span></span>
<span><span class="co">#&gt;  [49] "Diesel trains -&gt; RaP"                                              </span></span>
<span><span class="co">#&gt;  [50] "Domestic aircraft -&gt; AirP"                                         </span></span>
<span><span class="co">#&gt;  [51] "Domestic appliances -&gt; MD"                                         </span></span>
<span><span class="co">#&gt;  [52] "Domestic boats -&gt; MaP"                                             </span></span>
<span><span class="co">#&gt;  [53] "Domestic electric lamps -&gt; L"                                      </span></span>
<span><span class="co">#&gt;  [54] "Domestic electric ovens -&gt; MTH.200.C"                              </span></span>
<span><span class="co">#&gt;  [55] "Domestic gas ovens -&gt; MTH.200.C"                                   </span></span>
<span><span class="co">#&gt;  [56] "Electric arc furnaces -&gt; HTH.1600.C"                               </span></span>
<span><span class="co">#&gt;  [57] "Electric cars -&gt; RoP"                                              </span></span>
<span><span class="co">#&gt;  [58] "Electric pumps -&gt; HPL"                                             </span></span>
<span><span class="co">#&gt;  [59] "Electric space heaters -&gt; LTH.20.C"                                </span></span>
<span><span class="co">#&gt;  [60] "Electric trains -&gt; RaP"                                            </span></span>
<span><span class="co">#&gt;  [61] "Electric water heaters -&gt; MTH.100.C"                               </span></span>
<span><span class="co">#&gt;  [62] "Electro-chemical processors -&gt; HTH.960.C"                          </span></span>
<span><span class="co">#&gt;  [63] "Gas pump jacks -&gt; HPL"                                             </span></span>
<span><span class="co">#&gt;  [64] "Gas space heaters -&gt; LTH.20.C"                                     </span></span>
<span><span class="co">#&gt;  [65] "Gas water heaters -&gt; MTH.100.C"                                    </span></span>
<span><span class="co">#&gt;  [66] "Gas works"                                                         </span></span>
<span><span class="co">#&gt;  [67] "Gasoline LDVs -&gt; RoP"                                              </span></span>
<span><span class="co">#&gt;  [68] "Gasoline motorcycles -&gt; RoP"                                       </span></span>
<span><span class="co">#&gt;  [69] "HVAC -&gt; LTC.20.C"                                                  </span></span>
<span><span class="co">#&gt;  [70] "Industrial electric lamps -&gt; L"                                    </span></span>
<span><span class="co">#&gt;  [71] "Industrial electric process heaters -&gt; HTH.600.C"                  </span></span>
<span><span class="co">#&gt;  [72] "Industrial fans -&gt; KE"                                             </span></span>
<span><span class="co">#&gt;  [73] "Industrial refrigerators -&gt; LTC.-10.C"                             </span></span>
<span><span class="co">#&gt;  [74] "Kerosene stoves -&gt; MTH.100.C"                                      </span></span>
<span><span class="co">#&gt;  [75] "LPG stoves -&gt; LTH.20.C"                                            </span></span>
<span><span class="co">#&gt;  [76] "LPG stoves -&gt; LTH.50.C"                                            </span></span>
<span><span class="co">#&gt;  [77] "LPG stoves -&gt; MTH.100.C"                                           </span></span>
<span><span class="co">#&gt;  [78] "Machine tools -&gt; MacW"                                             </span></span>
<span><span class="co">#&gt;  [79] "Main activity producer electricity plants"                         </span></span>
<span><span class="co">#&gt;  [80] "Manufacture [of Geothermal]"                                       </span></span>
<span><span class="co">#&gt;  [81] "Manufacture [of Hydro]"                                            </span></span>
<span><span class="co">#&gt;  [82] "Manufacture [of Non-specified primary biofuels and waste]"         </span></span>
<span><span class="co">#&gt;  [83] "Manufacture [of Nuclear]"                                          </span></span>
<span><span class="co">#&gt;  [84] "Material handlers -&gt; MacW"                                         </span></span>
<span><span class="co">#&gt;  [85] "Natural gas extraction"                                            </span></span>
<span><span class="co">#&gt;  [86] "Natural gas vehicles -&gt; RoP"                                       </span></span>
<span><span class="co">#&gt;  [87] "Non-energy consumption -&gt; NEU"                                     </span></span>
<span><span class="co">#&gt;  [88] "Nuclear industry"                                                  </span></span>
<span><span class="co">#&gt;  [89] "Oil extraction"                                                    </span></span>
<span><span class="co">#&gt;  [90] "Oil refineries"                                                    </span></span>
<span><span class="co">#&gt;  [91] "Oil space heaters -&gt; LTH.20.C"                                     </span></span>
<span><span class="co">#&gt;  [92] "Oil water heaters -&gt; MTH.100.C"                                    </span></span>
<span><span class="co">#&gt;  [93] "Patent fuel plants"                                                </span></span>
<span><span class="co">#&gt;  [94] "Refrigerators -&gt; LTC.-10.C"                                        </span></span>
<span><span class="co">#&gt;  [95] "Room air conditioners -&gt; LTC.20.C"                                 </span></span>
<span><span class="co">#&gt;  [96] "Small scale biomass boilers -&gt; HTH.1300.C"                         </span></span>
<span><span class="co">#&gt;  [97] "Static diesel engines -&gt; MD"                                       </span></span>
<span><span class="co">#&gt;  [98] "Static gasoline engines -&gt; MD"                                     </span></span>
<span><span class="co">#&gt;  [99] "Steam cracking furnaces -&gt; HTH.850.C"                              </span></span>
<span><span class="co">#&gt; [100] "Steam trains -&gt; RaP"                                               </span></span>
<span><span class="co">#&gt; [101] "Tractors -&gt; MacW"                                                  </span></span>
<span><span class="co">#&gt; [102] "Transfers"                                                         </span></span>
<span><span class="co">#&gt; [103] "Wood stoves -&gt; MTH.100.C"                                          </span></span>
<span><span class="co">#&gt; [104] "Agriculture/forestry"                                              </span></span>
<span><span class="co">#&gt; [105] "Chemical and petrochemical"                                        </span></span>
<span><span class="co">#&gt; [106] "Commercial and public services"                                    </span></span>
<span><span class="co">#&gt; [107] "Domestic aviation"                                                 </span></span>
<span><span class="co">#&gt; [108] "Domestic navigation"                                               </span></span>
<span><span class="co">#&gt; [109] "Exports [of Bitumen]"                                              </span></span>
<span><span class="co">#&gt; [110] "Exports [of Coke oven coke]"                                       </span></span>
<span><span class="co">#&gt; [111] "Exports [of Crude/NGL/feedstocks]"                                 </span></span>
<span><span class="co">#&gt; [112] "Exports [of Electricity]"                                          </span></span>
<span><span class="co">#&gt; [113] "Exports [of Fuel oil]"                                             </span></span>
<span><span class="co">#&gt; [114] "Exports [of Gas/diesel oil excl]"                                  </span></span>
<span><span class="co">#&gt; [115] "Exports [of Hard coal]"                                            </span></span>
<span><span class="co">#&gt; [116] "Exports [of Kerosene type jet fuel excl]"                          </span></span>
<span><span class="co">#&gt; [117] "Exports [of Liquefied petroleum gases]"                            </span></span>
<span><span class="co">#&gt; [118] "Exports [of Lubricants]"                                           </span></span>
<span><span class="co">#&gt; [119] "Exports [of Motor gasoline excl]"                                  </span></span>
<span><span class="co">#&gt; [120] "Exports [of Natural gas]"                                          </span></span>
<span><span class="co">#&gt; [121] "Exports [of Other kerosene]"                                       </span></span>
<span><span class="co">#&gt; [122] "Exports [of Other oil products]"                                   </span></span>
<span><span class="co">#&gt; [123] "Exports [of Paraffin waxes]"                                       </span></span>
<span><span class="co">#&gt; [124] "Exports [of Patent fuel]"                                          </span></span>
<span><span class="co">#&gt; [125] "Exports [of Petroleum coke]"                                       </span></span>
<span><span class="co">#&gt; [126] "Exports to World aviation bunkers [of Kerosene type jet fuel excl]"</span></span>
<span><span class="co">#&gt; [127] "Exports to World marine bunkers [of Fuel oil]"                     </span></span>
<span><span class="co">#&gt; [128] "Exports to World marine bunkers [of Gas/diesel oil excl]"          </span></span>
<span><span class="co">#&gt; [129] "Exports to World marine bunkers [of Hard coal]"                    </span></span>
<span><span class="co">#&gt; [130] "Final consumption not elsewhere specified"                         </span></span>
<span><span class="co">#&gt; [131] "Industry not elsewhere specified"                                  </span></span>
<span><span class="co">#&gt; [132] "Iron and steel"                                                    </span></span>
<span><span class="co">#&gt; [133] "Losses"                                                            </span></span>
<span><span class="co">#&gt; [134] "Non-energy use in transport"                                       </span></span>
<span><span class="co">#&gt; [135] "Non-energy use industry/transformation/energy"                     </span></span>
<span><span class="co">#&gt; [136] "Rail"                                                              </span></span>
<span><span class="co">#&gt; [137] "Residential"                                                       </span></span>
<span><span class="co">#&gt; [138] "Road"                                                              </span></span>
<span><span class="co">#&gt; [139] "Stock changes [of Coke oven coke]"                                 </span></span>
<span><span class="co">#&gt; [140] "Stock changes [of Liquefied petroleum gases]"                      </span></span>
<span><span class="co">#&gt; [141] "Stock changes [of Lubricants]"                                     </span></span>
<span><span class="co">#&gt; [142] "Stock changes [of Motor gasoline excl]"                            </span></span>
<span><span class="co">#&gt; [143] "Stock changes [of Natural gas]"                                    </span></span>
<span><span class="co">#&gt; [144] "Stock changes [of Other kerosene]"                                 </span></span>
<span><span class="co">#&gt; [145] "Stock changes [of Paraffin waxes]"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="get-lists-of-unique-product-and-industry-names">Get lists of unique product and industry names<a class="anchor" aria-label="anchor" href="#get-lists-of-unique-product-and-industry-names"></a>
</h2>
<p>To obtain lists of unique product and industry names, one can use
<code><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Unique products in the data frame</span></span>
<span><span class="va">df_with_prods_inds</span><span class="op">$</span><span class="va">Product.names</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   [1] "Bitumen"                                                  </span></span>
<span><span class="co">#&gt;   [2] "Brown coal (if no detail) [from Resources]"               </span></span>
<span><span class="co">#&gt;   [3] "Coke oven coke"                                           </span></span>
<span><span class="co">#&gt;   [4] "Crude/NGL/feedstocks (if no detail)"                      </span></span>
<span><span class="co">#&gt;   [5] "Crude/NGL/feedstocks (if no detail) [from Resources]"     </span></span>
<span><span class="co">#&gt;   [6] "Electricity"                                              </span></span>
<span><span class="co">#&gt;   [7] "Fuel oil"                                                 </span></span>
<span><span class="co">#&gt;   [8] "Gas/diesel oil excl. biofuels"                            </span></span>
<span><span class="co">#&gt;   [9] "Geothermal [from Resources]"                              </span></span>
<span><span class="co">#&gt;  [10] "Hard coal (if no detail)"                                 </span></span>
<span><span class="co">#&gt;  [11] "Hard coal (if no detail) [from Resources]"                </span></span>
<span><span class="co">#&gt;  [12] "Hydro [from Resources]"                                   </span></span>
<span><span class="co">#&gt;  [13] "Kerosene type jet fuel excl. biofuels"                    </span></span>
<span><span class="co">#&gt;  [14] "Liquefied petroleum gases (LPG)"                          </span></span>
<span><span class="co">#&gt;  [15] "Lubricants"                                               </span></span>
<span><span class="co">#&gt;  [16] "Motor gasoline excl. biofuels"                            </span></span>
<span><span class="co">#&gt;  [17] "Natural gas"                                              </span></span>
<span><span class="co">#&gt;  [18] "Natural gas [from Resources]"                             </span></span>
<span><span class="co">#&gt;  [19] "Non-specified primary biofuels and waste"                 </span></span>
<span><span class="co">#&gt;  [20] "Non-specified primary biofuels and waste [from Resources]"</span></span>
<span><span class="co">#&gt;  [21] "Nuclear [from Resources]"                                 </span></span>
<span><span class="co">#&gt;  [22] "Other kerosene"                                           </span></span>
<span><span class="co">#&gt;  [23] "Other oil products"                                       </span></span>
<span><span class="co">#&gt;  [24] "Paraffin waxes"                                           </span></span>
<span><span class="co">#&gt;  [25] "Patent fuel"                                              </span></span>
<span><span class="co">#&gt;  [26] "Petroleum coke"                                           </span></span>
<span><span class="co">#&gt;  [27] "Blast furnace gas"                                        </span></span>
<span><span class="co">#&gt;  [28] "Brown coal (if no detail)"                                </span></span>
<span><span class="co">#&gt;  [29] "Coke oven gas"                                            </span></span>
<span><span class="co">#&gt;  [30] "Gas coke"                                                 </span></span>
<span><span class="co">#&gt;  [31] "Gas works gas"                                            </span></span>
<span><span class="co">#&gt;  [32] "Geothermal"                                               </span></span>
<span><span class="co">#&gt;  [33] "Hydro"                                                    </span></span>
<span><span class="co">#&gt;  [34] "Nuclear"                                                  </span></span>
<span><span class="co">#&gt;  [35] "Refinery gas"                                             </span></span>
<span><span class="co">#&gt;  [36] "Aviation gasoline"                                        </span></span>
<span><span class="co">#&gt;  [37] "Naphtha"                                                  </span></span>
<span><span class="co">#&gt;  [38] "Crude oil"                                                </span></span>
<span><span class="co">#&gt;  [39] "Crude oil [from Resources]"                               </span></span>
<span><span class="co">#&gt;  [40] "Natural gas liquids [from Resources]"                     </span></span>
<span><span class="co">#&gt;  [41] "Natural gas liquids"                                      </span></span>
<span><span class="co">#&gt;  [42] "Refinery feedstocks"                                      </span></span>
<span><span class="co">#&gt;  [43] "Coking coal"                                              </span></span>
<span><span class="co">#&gt;  [44] "Coking coal [from Resources]"                             </span></span>
<span><span class="co">#&gt;  [45] "Gasoline type jet fuel"                                   </span></span>
<span><span class="co">#&gt;  [46] "Lignite [from Resources]"                                 </span></span>
<span><span class="co">#&gt;  [47] "Other bituminous coal"                                    </span></span>
<span><span class="co">#&gt;  [48] "Other bituminous coal [from Resources]"                   </span></span>
<span><span class="co">#&gt;  [49] "Other hydrocarbons [from Resources]"                      </span></span>
<span><span class="co">#&gt;  [50] "Sub-bituminous coal [from Resources]"                     </span></span>
<span><span class="co">#&gt;  [51] "White spirit &amp; SBP"                                       </span></span>
<span><span class="co">#&gt;  [52] "Lignite"                                                  </span></span>
<span><span class="co">#&gt;  [53] "Other hydrocarbons"                                       </span></span>
<span><span class="co">#&gt;  [54] "Sub-bituminous coal"                                      </span></span>
<span><span class="co">#&gt;  [55] "Heat"                                                     </span></span>
<span><span class="co">#&gt;  [56] "Solar photovoltaics [from Resources]"                     </span></span>
<span><span class="co">#&gt;  [57] "Solar photovoltaics"                                      </span></span>
<span><span class="co">#&gt;  [58] "Solar thermal [from Resources]"                           </span></span>
<span><span class="co">#&gt;  [59] "Wind [from Resources]"                                    </span></span>
<span><span class="co">#&gt;  [60] "Solar thermal"                                            </span></span>
<span><span class="co">#&gt;  [61] "Wind"                                                     </span></span>
<span><span class="co">#&gt;  [62] "Biogases [from Resources]"                                </span></span>
<span><span class="co">#&gt;  [63] "Ethane"                                                   </span></span>
<span><span class="co">#&gt;  [64] "Industrial waste [from Resources]"                        </span></span>
<span><span class="co">#&gt;  [65] "Municipal waste (non-renewable) [from Resources]"         </span></span>
<span><span class="co">#&gt;  [66] "Municipal waste (renewable) [from Resources]"             </span></span>
<span><span class="co">#&gt;  [67] "Primary solid biofuels"                                   </span></span>
<span><span class="co">#&gt;  [68] "Primary solid biofuels [from Resources]"                  </span></span>
<span><span class="co">#&gt;  [69] "Biogases"                                                 </span></span>
<span><span class="co">#&gt;  [70] "Industrial waste"                                         </span></span>
<span><span class="co">#&gt;  [71] "Municipal waste (non-renewable)"                          </span></span>
<span><span class="co">#&gt;  [72] "Municipal waste (renewable)"                              </span></span>
<span><span class="co">#&gt;  [73] "Peat [from Resources]"                                    </span></span>
<span><span class="co">#&gt;  [74] "Peat"                                                     </span></span>
<span><span class="co">#&gt;  [75] "Additives/blending components"                            </span></span>
<span><span class="co">#&gt;  [76] "Additives/blending components [from Resources]"           </span></span>
<span><span class="co">#&gt;  [77] "Biogasoline"                                              </span></span>
<span><span class="co">#&gt;  [78] "Biogasoline [from Resources]"                             </span></span>
<span><span class="co">#&gt;  [79] "Biodiesels"                                               </span></span>
<span><span class="co">#&gt;  [80] "Biodiesels [from Resources]"                              </span></span>
<span><span class="co">#&gt;  [81] "Other liquid biofuels"                                    </span></span>
<span><span class="co">#&gt;  [82] "Other liquid biofuels [from Resources]"                   </span></span>
<span><span class="co">#&gt;  [83] "Anthracite"                                               </span></span>
<span><span class="co">#&gt;  [84] "Anthracite [from Resources]"                              </span></span>
<span><span class="co">#&gt;  [85] "HPA [from Air compressors]"                               </span></span>
<span><span class="co">#&gt;  [86] "HPL [from Electric pumps]"                                </span></span>
<span><span class="co">#&gt;  [87] "HPL [from Gas pump jacks]"                                </span></span>
<span><span class="co">#&gt;  [88] "HTH.1600.C [from Blast oxygen furnaces]"                  </span></span>
<span><span class="co">#&gt;  [89] "HTH.600.C [from Industrial electric process heaters]"     </span></span>
<span><span class="co">#&gt;  [90] "HTH.850.C [from Steam cracking furnaces]"                 </span></span>
<span><span class="co">#&gt;  [91] "HTH.960.C [from Electro-chemical processors]"             </span></span>
<span><span class="co">#&gt;  [92] "IP [from Computers]"                                      </span></span>
<span><span class="co">#&gt;  [93] "KE [from Industrial fans]"                                </span></span>
<span><span class="co">#&gt;  [94] "L [from Industrial electric lamps]"                       </span></span>
<span><span class="co">#&gt;  [95] "LTC.-10.C [from Industrial refrigerators]"                </span></span>
<span><span class="co">#&gt;  [96] "LTC.20.C [from HVAC]"                                     </span></span>
<span><span class="co">#&gt;  [97] "LTH.20.C [from Gas space heaters]"                        </span></span>
<span><span class="co">#&gt;  [98] "MacW [from Machine tools]"                                </span></span>
<span><span class="co">#&gt;  [99] "MacW [from Material handlers]"                            </span></span>
<span><span class="co">#&gt; [100] "MTH.100.C [from Gas water heaters]"                       </span></span>
<span><span class="co">#&gt; [101] "RoP [from Electric cars]"                                 </span></span>
<span><span class="co">#&gt; [102] "AirP [from Domestic aircraft]"                            </span></span>
<span><span class="co">#&gt; [103] "HTH.1300.C [from Small scale biomass boilers]"            </span></span>
<span><span class="co">#&gt; [104] "HTH.1600.C [from Electric arc furnaces]"                  </span></span>
<span><span class="co">#&gt; [105] "L [from Commercial indoor electric lamps]"                </span></span>
<span><span class="co">#&gt; [106] "L [from Commercial outdoor electric lamps]"               </span></span>
<span><span class="co">#&gt; [107] "L [from Domestic electric lamps]"                         </span></span>
<span><span class="co">#&gt; [108] "LTC.-10.C [from Refrigerators]"                           </span></span>
<span><span class="co">#&gt; [109] "LTC.20.C [from Room air conditioners]"                    </span></span>
<span><span class="co">#&gt; [110] "LTH.20.C [from Coal stoves]"                              </span></span>
<span><span class="co">#&gt; [111] "LTH.20.C [from Electric space heaters]"                   </span></span>
<span><span class="co">#&gt; [112] "LTH.20.C [from LPG stoves]"                               </span></span>
<span><span class="co">#&gt; [113] "LTH.20.C [from Oil space heaters]"                        </span></span>
<span><span class="co">#&gt; [114] "LTH.50.C [from Coal stoves]"                              </span></span>
<span><span class="co">#&gt; [115] "LTH.50.C [from LPG stoves]"                               </span></span>
<span><span class="co">#&gt; [116] "MacW [from Tractors]"                                     </span></span>
<span><span class="co">#&gt; [117] "MaP [from Domestic boats]"                                </span></span>
<span><span class="co">#&gt; [118] "MD [from Domestic appliances]"                            </span></span>
<span><span class="co">#&gt; [119] "MD [from Static diesel engines]"                          </span></span>
<span><span class="co">#&gt; [120] "MD [from Static gasoline engines]"                        </span></span>
<span><span class="co">#&gt; [121] "MTH.100.C [from Coal stoves]"                             </span></span>
<span><span class="co">#&gt; [122] "MTH.100.C [from Electric water heaters]"                  </span></span>
<span><span class="co">#&gt; [123] "MTH.100.C [from Kerosene stoves]"                         </span></span>
<span><span class="co">#&gt; [124] "MTH.100.C [from LPG stoves]"                              </span></span>
<span><span class="co">#&gt; [125] "MTH.100.C [from Oil water heaters]"                       </span></span>
<span><span class="co">#&gt; [126] "MTH.100.C [from Wood stoves]"                             </span></span>
<span><span class="co">#&gt; [127] "MTH.200.C [from Coal stoves]"                             </span></span>
<span><span class="co">#&gt; [128] "MTH.200.C [from Commercial electric ovens]"               </span></span>
<span><span class="co">#&gt; [129] "MTH.200.C [from Commercial gas ovens]"                    </span></span>
<span><span class="co">#&gt; [130] "MTH.200.C [from Domestic electric ovens]"                 </span></span>
<span><span class="co">#&gt; [131] "MTH.200.C [from Domestic gas ovens]"                      </span></span>
<span><span class="co">#&gt; [132] "NEU [from Non-energy consumption]"                        </span></span>
<span><span class="co">#&gt; [133] "RaP [from Diesel trains]"                                 </span></span>
<span><span class="co">#&gt; [134] "RaP [from Electric trains]"                               </span></span>
<span><span class="co">#&gt; [135] "RaP [from Steam trains]"                                  </span></span>
<span><span class="co">#&gt; [136] "RoP [from Diesel HDVs]"                                   </span></span>
<span><span class="co">#&gt; [137] "RoP [from Gasoline LDVs]"                                 </span></span>
<span><span class="co">#&gt; [138] "RoP [from Gasoline motorcycles]"                          </span></span>
<span><span class="co">#&gt; [139] "RoP [from Natural gas vehicles]"                          </span></span>
<span><span class="co">#&gt; [140] "MacW [from Electric cable shovels]"                       </span></span>
<span><span class="co">#&gt; [141] "MF [from Electric continuous miners]"                     </span></span>
<span><span class="co">#&gt; [142] "MF [from Ore grinding mills]"                             </span></span>
<span><span class="co">#&gt; [143] "HPNG [from Pipeline gas compressors]"                     </span></span>
<span><span class="co">#&gt; [144] "HTH.1000.C [from Clinker kilns]"                          </span></span>
<span><span class="co">#&gt; [145] "HTH.400.C [from Ammonia synthesizers]"                    </span></span>
<span><span class="co">#&gt; [146] "HTH.960.C [from Electrolytic smelters]"                   </span></span>
<span><span class="co">#&gt; [147] "MacW [from Paper machines]"                               </span></span>
<span><span class="co">#&gt; [148] "MTH.200.C [from Bayer kilns]"                             </span></span>
<span><span class="co">#&gt; [149] "MTH.300.C [from Heat machines]"                           </span></span>
<span><span class="co">#&gt; [150] "MacW [from Diesel bulldozers]"                            </span></span>
<span><span class="co">#&gt; [151] "MacW [from Diesel hydraulic mobiles]"                     </span></span>
<span><span class="co">#&gt; [152] "RoP [from Diesel haulage trucks]"                         </span></span>
<span><span class="co">#&gt; [153] "LTH.20.C [from Ground source heat pumps]"                 </span></span>
<span><span class="co">#&gt; [154] "LTH.20.C [from Wood stoves]"                              </span></span>
<span><span class="co">#&gt; [155] "LTH.50.C [from Wood stoves]"                              </span></span>
<span><span class="co">#&gt; [156] "LTH.60.C [from Solar thermal water heaters]"              </span></span>
<span><span class="co">#&gt; [157] "MacW [from Electric cable cranes]"                        </span></span>
<span><span class="co">#&gt; [158] "MacW [from Electric hand tools]"                          </span></span>
<span><span class="co">#&gt; [159] "MacW [from Electric hydraulic mobiles]"                   </span></span>
<span><span class="co">#&gt; [160] "MF [from Diesel rock borers]"                             </span></span>
<span><span class="co">#&gt; [161] "HPL [from Diesel pumps]"                                  </span></span>
<span><span class="co">#&gt; [162] "Biomass [from Resources]"                                 </span></span>
<span><span class="co">#&gt; [163] "Biomass"                                                  </span></span>
<span><span class="co">#&gt; [164] "Feed"                                                     </span></span>
<span><span class="co">#&gt; [165] "Food"                                                     </span></span>
<span><span class="co">#&gt; [166] "AnMech [from Asses]"                                      </span></span>
<span><span class="co">#&gt; [167] "AnMech [from Buffaloes]"                                  </span></span>
<span><span class="co">#&gt; [168] "AnMech [from Camelids]"                                   </span></span>
<span><span class="co">#&gt; [169] "AnMech [from Cattle]"                                     </span></span>
<span><span class="co">#&gt; [170] "AnMech [from Horses]"                                     </span></span>
<span><span class="co">#&gt; [171] "AnMech [from Mules]"                                      </span></span>
<span><span class="co">#&gt; [172] "HuMech [from Human females]"                              </span></span>
<span><span class="co">#&gt; [173] "HuMech [from Human males]"</span></span>
<span></span>
<span><span class="co"># Unique industries in the data frame</span></span>
<span><span class="va">df_with_prods_inds</span><span class="op">$</span><span class="va">Industry.names</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   [1] "Imports [of Bitumen]"                                              </span></span>
<span><span class="co">#&gt;   [2] "Imports [of Coke oven coke]"                                       </span></span>
<span><span class="co">#&gt;   [3] "Imports [of Crude/NGL/feedstocks]"                                 </span></span>
<span><span class="co">#&gt;   [4] "Imports [of Electricity]"                                          </span></span>
<span><span class="co">#&gt;   [5] "Imports [of Fuel oil]"                                             </span></span>
<span><span class="co">#&gt;   [6] "Imports [of Gas/diesel oil excl]"                                  </span></span>
<span><span class="co">#&gt;   [7] "Imports [of Hard coal]"                                            </span></span>
<span><span class="co">#&gt;   [8] "Imports [of Kerosene type jet fuel excl]"                          </span></span>
<span><span class="co">#&gt;   [9] "Imports [of Liquefied petroleum gases]"                            </span></span>
<span><span class="co">#&gt;  [10] "Imports [of Lubricants]"                                           </span></span>
<span><span class="co">#&gt;  [11] "Imports [of Motor gasoline excl]"                                  </span></span>
<span><span class="co">#&gt;  [12] "Imports [of Natural gas]"                                          </span></span>
<span><span class="co">#&gt;  [13] "Imports [of Other kerosene]"                                       </span></span>
<span><span class="co">#&gt;  [14] "Imports [of Other oil products]"                                   </span></span>
<span><span class="co">#&gt;  [15] "Imports [of Paraffin waxes]"                                       </span></span>
<span><span class="co">#&gt;  [16] "Imports [of Patent fuel]"                                          </span></span>
<span><span class="co">#&gt;  [17] "Resources [of Brown coal (if no detail)]"                          </span></span>
<span><span class="co">#&gt;  [18] "Resources [of Crude/NGL/feedstocks (if no detail)]"                </span></span>
<span><span class="co">#&gt;  [19] "Resources [of Geothermal]"                                         </span></span>
<span><span class="co">#&gt;  [20] "Resources [of Hard coal (if no detail)]"                           </span></span>
<span><span class="co">#&gt;  [21] "Resources [of Hydro]"                                              </span></span>
<span><span class="co">#&gt;  [22] "Resources [of Natural gas]"                                        </span></span>
<span><span class="co">#&gt;  [23] "Resources [of Non-specified primary biofuels and waste]"           </span></span>
<span><span class="co">#&gt;  [24] "Resources [of Nuclear]"                                            </span></span>
<span><span class="co">#&gt;  [25] "Statistical differences"                                           </span></span>
<span><span class="co">#&gt;  [26] "Stock changes [of Bitumen]"                                        </span></span>
<span><span class="co">#&gt;  [27] "Stock changes [of Crude/NGL/feedstocks]"                           </span></span>
<span><span class="co">#&gt;  [28] "Stock changes [of Fuel oil]"                                       </span></span>
<span><span class="co">#&gt;  [29] "Stock changes [of Gas/diesel oil excl]"                            </span></span>
<span><span class="co">#&gt;  [30] "Stock changes [of Hard coal]"                                      </span></span>
<span><span class="co">#&gt;  [31] "Stock changes [of Kerosene type jet fuel excl]"                    </span></span>
<span><span class="co">#&gt;  [32] "Stock changes [of Other oil products]"                             </span></span>
<span><span class="co">#&gt;  [33] "Stock changes [of Petroleum coke]"                                 </span></span>
<span><span class="co">#&gt;  [34] "Blast furnaces"                                                    </span></span>
<span><span class="co">#&gt;  [35] "Coal mines"                                                        </span></span>
<span><span class="co">#&gt;  [36] "Coke ovens"                                                        </span></span>
<span><span class="co">#&gt;  [37] "Gas works"                                                         </span></span>
<span><span class="co">#&gt;  [38] "Main activity producer electricity plants"                         </span></span>
<span><span class="co">#&gt;  [39] "Manufacture [of Geothermal]"                                       </span></span>
<span><span class="co">#&gt;  [40] "Manufacture [of Hydro]"                                            </span></span>
<span><span class="co">#&gt;  [41] "Manufacture [of Non-specified primary biofuels and waste]"         </span></span>
<span><span class="co">#&gt;  [42] "Manufacture [of Nuclear]"                                          </span></span>
<span><span class="co">#&gt;  [43] "Natural gas extraction"                                            </span></span>
<span><span class="co">#&gt;  [44] "Nuclear industry"                                                  </span></span>
<span><span class="co">#&gt;  [45] "Oil extraction"                                                    </span></span>
<span><span class="co">#&gt;  [46] "Oil refineries"                                                    </span></span>
<span><span class="co">#&gt;  [47] "Patent fuel plants"                                                </span></span>
<span><span class="co">#&gt;  [48] "Transfers"                                                         </span></span>
<span><span class="co">#&gt;  [49] "Agriculture/forestry"                                              </span></span>
<span><span class="co">#&gt;  [50] "Chemical and petrochemical"                                        </span></span>
<span><span class="co">#&gt;  [51] "Commercial and public services"                                    </span></span>
<span><span class="co">#&gt;  [52] "Domestic aviation"                                                 </span></span>
<span><span class="co">#&gt;  [53] "Domestic navigation"                                               </span></span>
<span><span class="co">#&gt;  [54] "Exports [of Bitumen]"                                              </span></span>
<span><span class="co">#&gt;  [55] "Exports [of Coke oven coke]"                                       </span></span>
<span><span class="co">#&gt;  [56] "Exports [of Crude/NGL/feedstocks]"                                 </span></span>
<span><span class="co">#&gt;  [57] "Exports [of Electricity]"                                          </span></span>
<span><span class="co">#&gt;  [58] "Exports [of Fuel oil]"                                             </span></span>
<span><span class="co">#&gt;  [59] "Exports [of Gas/diesel oil excl]"                                  </span></span>
<span><span class="co">#&gt;  [60] "Exports [of Hard coal]"                                            </span></span>
<span><span class="co">#&gt;  [61] "Exports [of Kerosene type jet fuel excl]"                          </span></span>
<span><span class="co">#&gt;  [62] "Exports [of Liquefied petroleum gases]"                            </span></span>
<span><span class="co">#&gt;  [63] "Exports [of Lubricants]"                                           </span></span>
<span><span class="co">#&gt;  [64] "Exports [of Motor gasoline excl]"                                  </span></span>
<span><span class="co">#&gt;  [65] "Exports [of Natural gas]"                                          </span></span>
<span><span class="co">#&gt;  [66] "Exports [of Other kerosene]"                                       </span></span>
<span><span class="co">#&gt;  [67] "Exports [of Other oil products]"                                   </span></span>
<span><span class="co">#&gt;  [68] "Exports [of Paraffin waxes]"                                       </span></span>
<span><span class="co">#&gt;  [69] "Exports [of Patent fuel]"                                          </span></span>
<span><span class="co">#&gt;  [70] "Exports [of Petroleum coke]"                                       </span></span>
<span><span class="co">#&gt;  [71] "Exports to World aviation bunkers [of Kerosene type jet fuel excl]"</span></span>
<span><span class="co">#&gt;  [72] "Exports to World marine bunkers [of Fuel oil]"                     </span></span>
<span><span class="co">#&gt;  [73] "Exports to World marine bunkers [of Gas/diesel oil excl]"          </span></span>
<span><span class="co">#&gt;  [74] "Exports to World marine bunkers [of Hard coal]"                    </span></span>
<span><span class="co">#&gt;  [75] "Final consumption not elsewhere specified"                         </span></span>
<span><span class="co">#&gt;  [76] "Industry not elsewhere specified"                                  </span></span>
<span><span class="co">#&gt;  [77] "Iron and steel"                                                    </span></span>
<span><span class="co">#&gt;  [78] "Losses"                                                            </span></span>
<span><span class="co">#&gt;  [79] "Non-energy use in transport"                                       </span></span>
<span><span class="co">#&gt;  [80] "Non-energy use industry/transformation/energy"                     </span></span>
<span><span class="co">#&gt;  [81] "Rail"                                                              </span></span>
<span><span class="co">#&gt;  [82] "Residential"                                                       </span></span>
<span><span class="co">#&gt;  [83] "Road"                                                              </span></span>
<span><span class="co">#&gt;  [84] "Stock changes [of Coke oven coke]"                                 </span></span>
<span><span class="co">#&gt;  [85] "Stock changes [of Liquefied petroleum gases]"                      </span></span>
<span><span class="co">#&gt;  [86] "Stock changes [of Lubricants]"                                     </span></span>
<span><span class="co">#&gt;  [87] "Stock changes [of Motor gasoline excl]"                            </span></span>
<span><span class="co">#&gt;  [88] "Stock changes [of Natural gas]"                                    </span></span>
<span><span class="co">#&gt;  [89] "Stock changes [of Other kerosene]"                                 </span></span>
<span><span class="co">#&gt;  [90] "Stock changes [of Paraffin waxes]"                                 </span></span>
<span><span class="co">#&gt;  [91] "Imports [of Naphtha]"                                              </span></span>
<span><span class="co">#&gt;  [92] "Stock changes [of Naphtha]"                                        </span></span>
<span><span class="co">#&gt;  [93] "Stock changes [of Aviation gasoline]"                              </span></span>
<span><span class="co">#&gt;  [94] "Exports [of Aviation gasoline]"                                    </span></span>
<span><span class="co">#&gt;  [95] "Exports [of Naphtha]"                                              </span></span>
<span><span class="co">#&gt;  [96] "Exports [of Gas works gas]"                                        </span></span>
<span><span class="co">#&gt;  [97] "Pipeline transport"                                                </span></span>
<span><span class="co">#&gt;  [98] "Imports [of Crude oil]"                                            </span></span>
<span><span class="co">#&gt;  [99] "Resources [of Crude oil]"                                          </span></span>
<span><span class="co">#&gt; [100] "Resources [of Natural gas liquids]"                                </span></span>
<span><span class="co">#&gt; [101] "Exports [of Crude oil]"                                            </span></span>
<span><span class="co">#&gt; [102] "Food and tobacco"                                                  </span></span>
<span><span class="co">#&gt; [103] "Machinery"                                                         </span></span>
<span><span class="co">#&gt; [104] "Mining and quarrying"                                              </span></span>
<span><span class="co">#&gt; [105] "Non-ferrous metals"                                                </span></span>
<span><span class="co">#&gt; [106] "Non-metallic minerals"                                             </span></span>
<span><span class="co">#&gt; [107] "Paper, pulp and printing"                                          </span></span>
<span><span class="co">#&gt; [108] "Stock changes [of Crude oil]"                                      </span></span>
<span><span class="co">#&gt; [109] "Textile and leather"                                               </span></span>
<span><span class="co">#&gt; [110] "Transport equipment"                                               </span></span>
<span><span class="co">#&gt; [111] "Wood and wood products"                                            </span></span>
<span><span class="co">#&gt; [112] "Stock changes [of Patent fuel]"                                    </span></span>
<span><span class="co">#&gt; [113] "Imports [of Brown coal]"                                           </span></span>
<span><span class="co">#&gt; [114] "Exports [of Brown coal]"                                           </span></span>
<span><span class="co">#&gt; [115] "Imports [of Natural gas liquids]"                                  </span></span>
<span><span class="co">#&gt; [116] "Imports [of Refinery feedstocks]"                                  </span></span>
<span><span class="co">#&gt; [117] "Exports [of Natural gas liquids]"                                  </span></span>
<span><span class="co">#&gt; [118] "Stock changes [of Natural gas liquids]"                            </span></span>
<span><span class="co">#&gt; [119] "Stock changes [of Refinery feedstocks]"                            </span></span>
<span><span class="co">#&gt; [120] "Imports [of Aviation gasoline]"                                    </span></span>
<span><span class="co">#&gt; [121] "Imports [of Gasoline type jet fuel]"                               </span></span>
<span><span class="co">#&gt; [122] "Imports [of Other bituminous coal]"                                </span></span>
<span><span class="co">#&gt; [123] "Imports [of White spirit &amp; SBP]"                                   </span></span>
<span><span class="co">#&gt; [124] "Resources [of Coking coal]"                                        </span></span>
<span><span class="co">#&gt; [125] "Resources [of Lignite]"                                            </span></span>
<span><span class="co">#&gt; [126] "Resources [of Other bituminous coal]"                              </span></span>
<span><span class="co">#&gt; [127] "Resources [of Other hydrocarbons]"                                 </span></span>
<span><span class="co">#&gt; [128] "Resources [of Sub-bituminous coal]"                                </span></span>
<span><span class="co">#&gt; [129] "Stock changes [of Coking coal]"                                    </span></span>
<span><span class="co">#&gt; [130] "Stock changes [of Gasoline type jet fuel]"                         </span></span>
<span><span class="co">#&gt; [131] "Stock changes [of Other bituminous coal]"                          </span></span>
<span><span class="co">#&gt; [132] "Exports [of Coking coal]"                                          </span></span>
<span><span class="co">#&gt; [133] "Exports [of Lignite]"                                              </span></span>
<span><span class="co">#&gt; [134] "Exports [of Other bituminous coal]"                                </span></span>
<span><span class="co">#&gt; [135] "Exports [of White spirit &amp; SBP]"                                   </span></span>
<span><span class="co">#&gt; [136] "Stock changes [of Lignite]"                                        </span></span>
<span><span class="co">#&gt; [137] "Stock changes [of White spirit &amp; SBP]"                             </span></span>
<span><span class="co">#&gt; [138] "Exports [of Gasoline type jet fuel]"                               </span></span>
<span><span class="co">#&gt; [139] "Stock changes [of Sub-bituminous coal]"                            </span></span>
<span><span class="co">#&gt; [140] "Main activity producer CHP plants"                                 </span></span>
<span><span class="co">#&gt; [141] "Resources [of Solar photovoltaics]"                                </span></span>
<span><span class="co">#&gt; [142] "Stock changes [of Other hydrocarbons]"                             </span></span>
<span><span class="co">#&gt; [143] "Manufacture [of Solar photovoltaics]"                              </span></span>
<span><span class="co">#&gt; [144] "Construction"                                                      </span></span>
<span><span class="co">#&gt; [145] "Imports [of Petroleum coke]"                                       </span></span>
<span><span class="co">#&gt; [146] "Resources [of Solar thermal]"                                      </span></span>
<span><span class="co">#&gt; [147] "Resources [of Wind]"                                               </span></span>
<span><span class="co">#&gt; [148] "Manufacture [of Solar thermal]"                                    </span></span>
<span><span class="co">#&gt; [149] "Manufacture [of Wind]"                                             </span></span>
<span><span class="co">#&gt; [150] "Imports [of Other hydrocarbons]"                                   </span></span>
<span><span class="co">#&gt; [151] "Resources [of Biogases]"                                           </span></span>
<span><span class="co">#&gt; [152] "Resources [of Industrial waste]"                                   </span></span>
<span><span class="co">#&gt; [153] "Resources [of Municipal waste (non-renewable)]"                    </span></span>
<span><span class="co">#&gt; [154] "Resources [of Municipal waste (renewable)]"                        </span></span>
<span><span class="co">#&gt; [155] "Resources [of Primary solid biofuels]"                             </span></span>
<span><span class="co">#&gt; [156] "Stock changes [of Ethane]"                                         </span></span>
<span><span class="co">#&gt; [157] "For blended natural gas"                                           </span></span>
<span><span class="co">#&gt; [158] "Manufacture [of Biogases]"                                         </span></span>
<span><span class="co">#&gt; [159] "Manufacture [of Industrial waste]"                                 </span></span>
<span><span class="co">#&gt; [160] "Manufacture [of Municipal waste (non-renewable)]"                  </span></span>
<span><span class="co">#&gt; [161] "Manufacture [of Municipal waste (renewable)]"                      </span></span>
<span><span class="co">#&gt; [162] "Manufacture [of Primary solid biofuels]"                           </span></span>
<span><span class="co">#&gt; [163] "Transport not elsewhere specified"                                 </span></span>
<span><span class="co">#&gt; [164] "Imports [of Sub-bituminous coal]"                                  </span></span>
<span><span class="co">#&gt; [165] "Imports [of Ethane]"                                               </span></span>
<span><span class="co">#&gt; [166] "Resources [of Peat]"                                               </span></span>
<span><span class="co">#&gt; [167] "Main activity producer heat plants"                                </span></span>
<span><span class="co">#&gt; [168] "Manufacture [of Peat]"                                             </span></span>
<span><span class="co">#&gt; [169] "Imports [of Additives/blending components]"                        </span></span>
<span><span class="co">#&gt; [170] "Imports [of Biogasoline]"                                          </span></span>
<span><span class="co">#&gt; [171] "Resources [of Additives/blending components]"                      </span></span>
<span><span class="co">#&gt; [172] "Resources [of Biogasoline]"                                        </span></span>
<span><span class="co">#&gt; [173] "Manufacture [of Biogasoline]"                                      </span></span>
<span><span class="co">#&gt; [174] "Exports [of Sub-bituminous coal]"                                  </span></span>
<span><span class="co">#&gt; [175] "Stock changes [of Additives/blending components]"                  </span></span>
<span><span class="co">#&gt; [176] "Stock changes [of Biogasoline]"                                    </span></span>
<span><span class="co">#&gt; [177] "Exports [of Additives/blending components]"                        </span></span>
<span><span class="co">#&gt; [178] "Imports [of Coking coal]"                                          </span></span>
<span><span class="co">#&gt; [179] "Imports [of Lignite]"                                              </span></span>
<span><span class="co">#&gt; [180] "Resources [of Biodiesels]"                                         </span></span>
<span><span class="co">#&gt; [181] "Manufacture [of Biodiesels]"                                       </span></span>
<span><span class="co">#&gt; [182] "Resources [of Other liquid biofuels]"                              </span></span>
<span><span class="co">#&gt; [183] "Manufacture [of Other liquid biofuels]"                            </span></span>
<span><span class="co">#&gt; [184] "Imports [of Anthracite]"                                           </span></span>
<span><span class="co">#&gt; [185] "Resources [of Anthracite]"                                         </span></span>
<span><span class="co">#&gt; [186] "Stock changes [of Anthracite]"                                     </span></span>
<span><span class="co">#&gt; [187] "Exports [of Anthracite]"                                           </span></span>
<span><span class="co">#&gt; [188] "Imports [of Biodiesels]"                                           </span></span>
<span><span class="co">#&gt; [189] "Exports [of Biodiesels]"                                           </span></span>
<span><span class="co">#&gt; [190] "Stock changes [of Biodiesels]"                                     </span></span>
<span><span class="co">#&gt; [191] "Exports [of Biogasoline]"                                          </span></span>
<span><span class="co">#&gt; [192] "Non-specified"                                                     </span></span>
<span><span class="co">#&gt; [193] "Non-energy use in other"                                           </span></span>
<span><span class="co">#&gt; [194] "Exports to World marine bunkers [of Biodiesels]"                   </span></span>
<span><span class="co">#&gt; [195] "Exports [of Refinery feedstocks]"                                  </span></span>
<span><span class="co">#&gt; [196] "Exports [of Ethane]"                                               </span></span>
<span><span class="co">#&gt; [197] "Air compressors -&gt; HPA"                                            </span></span>
<span><span class="co">#&gt; [198] "Blast oxygen furnaces -&gt; HTH.1600.C"                               </span></span>
<span><span class="co">#&gt; [199] "Coal stoves -&gt; LTH.20.C"                                           </span></span>
<span><span class="co">#&gt; [200] "Coal stoves -&gt; LTH.50.C"                                           </span></span>
<span><span class="co">#&gt; [201] "Coal stoves -&gt; MTH.100.C"                                          </span></span>
<span><span class="co">#&gt; [202] "Coal stoves -&gt; MTH.200.C"                                          </span></span>
<span><span class="co">#&gt; [203] "Commercial electric ovens -&gt; MTH.200.C"                            </span></span>
<span><span class="co">#&gt; [204] "Commercial gas ovens -&gt; MTH.200.C"                                 </span></span>
<span><span class="co">#&gt; [205] "Commercial indoor electric lamps -&gt; L"                             </span></span>
<span><span class="co">#&gt; [206] "Commercial outdoor electric lamps -&gt; L"                            </span></span>
<span><span class="co">#&gt; [207] "Computers -&gt; IP"                                                   </span></span>
<span><span class="co">#&gt; [208] "Diesel HDVs -&gt; RoP"                                                </span></span>
<span><span class="co">#&gt; [209] "Diesel trains -&gt; RaP"                                              </span></span>
<span><span class="co">#&gt; [210] "Domestic aircraft -&gt; AirP"                                         </span></span>
<span><span class="co">#&gt; [211] "Domestic appliances -&gt; MD"                                         </span></span>
<span><span class="co">#&gt; [212] "Domestic boats -&gt; MaP"                                             </span></span>
<span><span class="co">#&gt; [213] "Domestic electric lamps -&gt; L"                                      </span></span>
<span><span class="co">#&gt; [214] "Domestic electric ovens -&gt; MTH.200.C"                              </span></span>
<span><span class="co">#&gt; [215] "Domestic gas ovens -&gt; MTH.200.C"                                   </span></span>
<span><span class="co">#&gt; [216] "Electric arc furnaces -&gt; HTH.1600.C"                               </span></span>
<span><span class="co">#&gt; [217] "Electric cars -&gt; RoP"                                              </span></span>
<span><span class="co">#&gt; [218] "Electric pumps -&gt; HPL"                                             </span></span>
<span><span class="co">#&gt; [219] "Electric space heaters -&gt; LTH.20.C"                                </span></span>
<span><span class="co">#&gt; [220] "Electric trains -&gt; RaP"                                            </span></span>
<span><span class="co">#&gt; [221] "Electric water heaters -&gt; MTH.100.C"                               </span></span>
<span><span class="co">#&gt; [222] "Electro-chemical processors -&gt; HTH.960.C"                          </span></span>
<span><span class="co">#&gt; [223] "Gas pump jacks -&gt; HPL"                                             </span></span>
<span><span class="co">#&gt; [224] "Gas space heaters -&gt; LTH.20.C"                                     </span></span>
<span><span class="co">#&gt; [225] "Gas water heaters -&gt; MTH.100.C"                                    </span></span>
<span><span class="co">#&gt; [226] "Gasoline LDVs -&gt; RoP"                                              </span></span>
<span><span class="co">#&gt; [227] "Gasoline motorcycles -&gt; RoP"                                       </span></span>
<span><span class="co">#&gt; [228] "HVAC -&gt; LTC.20.C"                                                  </span></span>
<span><span class="co">#&gt; [229] "Industrial electric lamps -&gt; L"                                    </span></span>
<span><span class="co">#&gt; [230] "Industrial electric process heaters -&gt; HTH.600.C"                  </span></span>
<span><span class="co">#&gt; [231] "Industrial fans -&gt; KE"                                             </span></span>
<span><span class="co">#&gt; [232] "Industrial refrigerators -&gt; LTC.-10.C"                             </span></span>
<span><span class="co">#&gt; [233] "Kerosene stoves -&gt; MTH.100.C"                                      </span></span>
<span><span class="co">#&gt; [234] "LPG stoves -&gt; LTH.20.C"                                            </span></span>
<span><span class="co">#&gt; [235] "LPG stoves -&gt; LTH.50.C"                                            </span></span>
<span><span class="co">#&gt; [236] "LPG stoves -&gt; MTH.100.C"                                           </span></span>
<span><span class="co">#&gt; [237] "Machine tools -&gt; MacW"                                             </span></span>
<span><span class="co">#&gt; [238] "Material handlers -&gt; MacW"                                         </span></span>
<span><span class="co">#&gt; [239] "Natural gas vehicles -&gt; RoP"                                       </span></span>
<span><span class="co">#&gt; [240] "Non-energy consumption -&gt; NEU"                                     </span></span>
<span><span class="co">#&gt; [241] "Oil space heaters -&gt; LTH.20.C"                                     </span></span>
<span><span class="co">#&gt; [242] "Oil water heaters -&gt; MTH.100.C"                                    </span></span>
<span><span class="co">#&gt; [243] "Refrigerators -&gt; LTC.-10.C"                                        </span></span>
<span><span class="co">#&gt; [244] "Room air conditioners -&gt; LTC.20.C"                                 </span></span>
<span><span class="co">#&gt; [245] "Small scale biomass boilers -&gt; HTH.1300.C"                         </span></span>
<span><span class="co">#&gt; [246] "Static diesel engines -&gt; MD"                                       </span></span>
<span><span class="co">#&gt; [247] "Static gasoline engines -&gt; MD"                                     </span></span>
<span><span class="co">#&gt; [248] "Steam cracking furnaces -&gt; HTH.850.C"                              </span></span>
<span><span class="co">#&gt; [249] "Steam trains -&gt; RaP"                                               </span></span>
<span><span class="co">#&gt; [250] "Tractors -&gt; MacW"                                                  </span></span>
<span><span class="co">#&gt; [251] "Wood stoves -&gt; MTH.100.C"                                          </span></span>
<span><span class="co">#&gt; [252] "Electric cable shovels -&gt; MacW"                                    </span></span>
<span><span class="co">#&gt; [253] "Electric continuous miners -&gt; MF"                                  </span></span>
<span><span class="co">#&gt; [254] "Ore grinding mills -&gt; MF"                                          </span></span>
<span><span class="co">#&gt; [255] "Pipeline gas compressors -&gt; HPNG"                                  </span></span>
<span><span class="co">#&gt; [256] "Ammonia synthesizers -&gt; HTH.400.C"                                 </span></span>
<span><span class="co">#&gt; [257] "Bayer kilns -&gt; MTH.200.C"                                          </span></span>
<span><span class="co">#&gt; [258] "Clinker kilns -&gt; HTH.1000.C"                                       </span></span>
<span><span class="co">#&gt; [259] "Electrolytic smelters -&gt; HTH.960.C"                                </span></span>
<span><span class="co">#&gt; [260] "Paper machines -&gt; MacW"                                            </span></span>
<span><span class="co">#&gt; [261] "Heat machines -&gt; MTH.300.C"                                        </span></span>
<span><span class="co">#&gt; [262] "Diesel bulldozers -&gt; MacW"                                         </span></span>
<span><span class="co">#&gt; [263] "Diesel haulage trucks -&gt; RoP"                                      </span></span>
<span><span class="co">#&gt; [264] "Diesel hydraulic mobiles -&gt; MacW"                                  </span></span>
<span><span class="co">#&gt; [265] "Ground source heat pumps -&gt; LTH.20.C"                              </span></span>
<span><span class="co">#&gt; [266] "Wood stoves -&gt; LTH.20.C"                                           </span></span>
<span><span class="co">#&gt; [267] "Wood stoves -&gt; LTH.50.C"                                           </span></span>
<span><span class="co">#&gt; [268] "Solar thermal water heaters -&gt; LTH.60.C"                           </span></span>
<span><span class="co">#&gt; [269] "Electric cable cranes -&gt; MacW"                                     </span></span>
<span><span class="co">#&gt; [270] "Electric hand tools -&gt; MacW"                                       </span></span>
<span><span class="co">#&gt; [271] "Electric hydraulic mobiles -&gt; MacW"                                </span></span>
<span><span class="co">#&gt; [272] "Diesel pumps -&gt; HPL"                                               </span></span>
<span><span class="co">#&gt; [273] "Diesel rock borers -&gt; MF"                                          </span></span>
<span><span class="co">#&gt; [274] "Resources [of Biomass]"                                            </span></span>
<span><span class="co">#&gt; [275] "Farms"                                                             </span></span>
<span><span class="co">#&gt; [276] "Feed production"                                                   </span></span>
<span><span class="co">#&gt; [277] "Food production"                                                   </span></span>
<span><span class="co">#&gt; [278] "Asses -&gt; AnMech"                                                   </span></span>
<span><span class="co">#&gt; [279] "Buffaloes -&gt; AnMech"                                               </span></span>
<span><span class="co">#&gt; [280] "Camelids -&gt; AnMech"                                                </span></span>
<span><span class="co">#&gt; [281] "Cattle -&gt; AnMech"                                                  </span></span>
<span><span class="co">#&gt; [282] "Horses -&gt; AnMech"                                                  </span></span>
<span><span class="co">#&gt; [283] "Human females -&gt; HuMech"                                           </span></span>
<span><span class="co">#&gt; [284] "Human males -&gt; HuMech"                                             </span></span>
<span><span class="co">#&gt; [285] "Mules -&gt; AnMech"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="aggregate-by-parts-of-row-and-column-labels">Aggregate by parts of row and column labels<a class="anchor" aria-label="anchor" href="#aggregate-by-parts-of-row-and-column-labels"></a>
</h2>
<p><code><a href="https://matthewheun.github.io/Recca/reference/get_all_products_and_industries.html" class="external-link">Recca::get_all_products_and_industries()</a></code> can also select
only parts of the row and column label. Knowing that we (eventually)
want to aggregate by the nouns, we can extract only the nouns (prefixes)
from the row and column labels, as shown by the code below. Extracting
by a piece of the row and column names is significantly slower than
extracting the entire row or column names.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_with_prods_inds_nouns</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Restrict years to reduce execution time.</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Year</span> <span class="op">==</span> <span class="fl">1960</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">Recca</span><span class="fu">::</span><span class="fu"><a href="https://matthewheun.github.io/Recca/reference/get_all_products_and_industries.html" class="external-link">get_all_products_and_industries</a></span><span class="op">(</span></span>
<span>    piece <span class="op">=</span> <span class="st">"noun"</span>,</span>
<span>    inf_notation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    notation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/bracket_notation.html" class="external-link">bracket_notation</a></span>, <span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/arrow_notation.html" class="external-link">arrow_notation</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">df_with_prods_inds_nouns</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 12</span></span>
<span><span class="co">#&gt; Columns: 16</span></span>
<span><span class="co">#&gt; $ Country        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "USA", "USA", "USA", "USA", "USA", "USA", "USA", "USA",…</span></span>
<span><span class="co">#&gt; $ Method         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM",…</span></span>
<span><span class="co">#&gt; $ Energy.type    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E", "E", "X", "X", "E", "E", "X", "X", "E", "E", "X", …</span></span>
<span><span class="co">#&gt; $ Last.stage     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Useful", "Final", "Useful", "Final", "Useful"…</span></span>
<span><span class="co">#&gt; $ Year           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1960, 1960, 1960, 1960, 1960, 1960, 1960, 1960, 1960, 1…</span></span>
<span><span class="co">#&gt; $ IEAMW          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "IEA", "IEA", "IEA", "IEA", "MW", "MW", "MW", "MW", "Bo…</span></span>
<span><span class="co">#&gt; $ Y              <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[24 x 43]&gt;&gt;, &lt;&lt;matrix[77 x 43]&gt;&gt;, &lt;&lt;matrix[24 …</span></span>
<span><span class="co">#&gt; $ S_units        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[36 x 1]&gt;&gt;, &lt;&lt;matrix[36 x 1]&gt;&gt;, &lt;&lt;matrix[36 x …</span></span>
<span><span class="co">#&gt; $ R              <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[33 x 26]&gt;&gt;, &lt;&lt;matrix[33 x 26]&gt;&gt;, &lt;&lt;matrix[33 …</span></span>
<span><span class="co">#&gt; $ U              <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[26 x 15]&gt;&gt;, &lt;&lt;matrix[53 x 70]&gt;&gt;, &lt;&lt;matrix[26 …</span></span>
<span><span class="co">#&gt; $ U_feed         <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[21 x 15]&gt;&gt;, &lt;&lt;matrix[36 x 70]&gt;&gt;, &lt;&lt;matrix[21 …</span></span>
<span><span class="co">#&gt; $ U_EIOU         <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[8 x 6]&gt;&gt;, &lt;&lt;matrix[17 x 6]&gt;&gt;, &lt;&lt;matrix[8 x 6]…</span></span>
<span><span class="co">#&gt; $ r_EIOU         <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[26 x 15]&gt;&gt;, &lt;&lt;matrix[53 x 70]&gt;&gt;, &lt;&lt;matrix[26 …</span></span>
<span><span class="co">#&gt; $ V              <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[15 x 28]&gt;&gt;, &lt;&lt;matrix[70 x 83]&gt;&gt;, &lt;&lt;matrix[15 …</span></span>
<span><span class="co">#&gt; $ Product.names  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;"Bitumen", "Brown coal (if no detail)", "Coke oven co…</span></span>
<span><span class="co">#&gt; $ Industry.names <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;"Imports", "Resources", "Statistical differences", "S…</span></span></code></pre></div>
<p>Again, one can use <code><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique()</a></code> to find the nouns required
for aggregation maps. These lists are shorter than lists of whole names
of products and industries, because there are fewer unique nouns than
unique row and column labels.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Unique products (nouns only) in the data frame</span></span>
<span><span class="va">df_with_prods_inds_nouns</span><span class="op">$</span><span class="va">Product.names</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Bitumen"                                 </span></span>
<span><span class="co">#&gt;  [2] "Brown coal (if no detail)"               </span></span>
<span><span class="co">#&gt;  [3] "Coke oven coke"                          </span></span>
<span><span class="co">#&gt;  [4] "Crude/NGL/feedstocks (if no detail)"     </span></span>
<span><span class="co">#&gt;  [5] "Electricity"                             </span></span>
<span><span class="co">#&gt;  [6] "Fuel oil"                                </span></span>
<span><span class="co">#&gt;  [7] "Gas/diesel oil excl. biofuels"           </span></span>
<span><span class="co">#&gt;  [8] "Geothermal"                              </span></span>
<span><span class="co">#&gt;  [9] "Hard coal (if no detail)"                </span></span>
<span><span class="co">#&gt; [10] "Hydro"                                   </span></span>
<span><span class="co">#&gt; [11] "Kerosene type jet fuel excl. biofuels"   </span></span>
<span><span class="co">#&gt; [12] "Liquefied petroleum gases (LPG)"         </span></span>
<span><span class="co">#&gt; [13] "Lubricants"                              </span></span>
<span><span class="co">#&gt; [14] "Motor gasoline excl. biofuels"           </span></span>
<span><span class="co">#&gt; [15] "Natural gas"                             </span></span>
<span><span class="co">#&gt; [16] "Non-specified primary biofuels and waste"</span></span>
<span><span class="co">#&gt; [17] "Nuclear"                                 </span></span>
<span><span class="co">#&gt; [18] "Other kerosene"                          </span></span>
<span><span class="co">#&gt; [19] "Other oil products"                      </span></span>
<span><span class="co">#&gt; [20] "Paraffin waxes"                          </span></span>
<span><span class="co">#&gt; [21] "Patent fuel"                             </span></span>
<span><span class="co">#&gt; [22] "Petroleum coke"                          </span></span>
<span><span class="co">#&gt; [23] "Blast furnace gas"                       </span></span>
<span><span class="co">#&gt; [24] "Coke oven gas"                           </span></span>
<span><span class="co">#&gt; [25] "Gas coke"                                </span></span>
<span><span class="co">#&gt; [26] "Gas works gas"                           </span></span>
<span><span class="co">#&gt; [27] "Refinery gas"                            </span></span>
<span><span class="co">#&gt; [28] "Aviation gasoline"                       </span></span>
<span><span class="co">#&gt; [29] "HPA"                                     </span></span>
<span><span class="co">#&gt; [30] "HPL"                                     </span></span>
<span><span class="co">#&gt; [31] "HTH.1600.C"                              </span></span>
<span><span class="co">#&gt; [32] "HTH.600.C"                               </span></span>
<span><span class="co">#&gt; [33] "HTH.850.C"                               </span></span>
<span><span class="co">#&gt; [34] "HTH.960.C"                               </span></span>
<span><span class="co">#&gt; [35] "IP"                                      </span></span>
<span><span class="co">#&gt; [36] "KE"                                      </span></span>
<span><span class="co">#&gt; [37] "L"                                       </span></span>
<span><span class="co">#&gt; [38] "LTC.-10.C"                               </span></span>
<span><span class="co">#&gt; [39] "LTC.20.C"                                </span></span>
<span><span class="co">#&gt; [40] "LTH.20.C"                                </span></span>
<span><span class="co">#&gt; [41] "MacW"                                    </span></span>
<span><span class="co">#&gt; [42] "MTH.100.C"                               </span></span>
<span><span class="co">#&gt; [43] "RoP"                                     </span></span>
<span><span class="co">#&gt; [44] "AirP"                                    </span></span>
<span><span class="co">#&gt; [45] "HTH.1300.C"                              </span></span>
<span><span class="co">#&gt; [46] "LTH.50.C"                                </span></span>
<span><span class="co">#&gt; [47] "MaP"                                     </span></span>
<span><span class="co">#&gt; [48] "MD"                                      </span></span>
<span><span class="co">#&gt; [49] "MTH.200.C"                               </span></span>
<span><span class="co">#&gt; [50] "NEU"                                     </span></span>
<span><span class="co">#&gt; [51] "RaP"                                     </span></span>
<span><span class="co">#&gt; [52] "Biomass"                                 </span></span>
<span><span class="co">#&gt; [53] "Feed"                                    </span></span>
<span><span class="co">#&gt; [54] "Food"                                    </span></span>
<span><span class="co">#&gt; [55] "AnMech"                                  </span></span>
<span><span class="co">#&gt; [56] "HuMech"</span></span>
<span></span>
<span><span class="co"># Unique industries (nouns only) in the data frame</span></span>
<span><span class="va">df_with_prods_inds_nouns</span><span class="op">$</span><span class="va">Industry.names</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Imports"                                      </span></span>
<span><span class="co">#&gt;  [2] "Resources"                                    </span></span>
<span><span class="co">#&gt;  [3] "Statistical differences"                      </span></span>
<span><span class="co">#&gt;  [4] "Stock changes"                                </span></span>
<span><span class="co">#&gt;  [5] "Blast furnaces"                               </span></span>
<span><span class="co">#&gt;  [6] "Coal mines"                                   </span></span>
<span><span class="co">#&gt;  [7] "Coke ovens"                                   </span></span>
<span><span class="co">#&gt;  [8] "Gas works"                                    </span></span>
<span><span class="co">#&gt;  [9] "Main activity producer electricity plants"    </span></span>
<span><span class="co">#&gt; [10] "Manufacture"                                  </span></span>
<span><span class="co">#&gt; [11] "Natural gas extraction"                       </span></span>
<span><span class="co">#&gt; [12] "Nuclear industry"                             </span></span>
<span><span class="co">#&gt; [13] "Oil extraction"                               </span></span>
<span><span class="co">#&gt; [14] "Oil refineries"                               </span></span>
<span><span class="co">#&gt; [15] "Patent fuel plants"                           </span></span>
<span><span class="co">#&gt; [16] "Transfers"                                    </span></span>
<span><span class="co">#&gt; [17] "Agriculture/forestry"                         </span></span>
<span><span class="co">#&gt; [18] "Chemical and petrochemical"                   </span></span>
<span><span class="co">#&gt; [19] "Commercial and public services"               </span></span>
<span><span class="co">#&gt; [20] "Domestic aviation"                            </span></span>
<span><span class="co">#&gt; [21] "Domestic navigation"                          </span></span>
<span><span class="co">#&gt; [22] "Exports"                                      </span></span>
<span><span class="co">#&gt; [23] "Exports to World aviation bunkers"            </span></span>
<span><span class="co">#&gt; [24] "Exports to World marine bunkers"              </span></span>
<span><span class="co">#&gt; [25] "Final consumption not elsewhere specified"    </span></span>
<span><span class="co">#&gt; [26] "Industry not elsewhere specified"             </span></span>
<span><span class="co">#&gt; [27] "Iron and steel"                               </span></span>
<span><span class="co">#&gt; [28] "Losses"                                       </span></span>
<span><span class="co">#&gt; [29] "Non-energy use in transport"                  </span></span>
<span><span class="co">#&gt; [30] "Non-energy use industry/transformation/energy"</span></span>
<span><span class="co">#&gt; [31] "Rail"                                         </span></span>
<span><span class="co">#&gt; [32] "Residential"                                  </span></span>
<span><span class="co">#&gt; [33] "Road"                                         </span></span>
<span><span class="co">#&gt; [34] "Air compressors"                              </span></span>
<span><span class="co">#&gt; [35] "Blast oxygen furnaces"                        </span></span>
<span><span class="co">#&gt; [36] "Coal stoves"                                  </span></span>
<span><span class="co">#&gt; [37] "Commercial electric ovens"                    </span></span>
<span><span class="co">#&gt; [38] "Commercial gas ovens"                         </span></span>
<span><span class="co">#&gt; [39] "Commercial indoor electric lamps"             </span></span>
<span><span class="co">#&gt; [40] "Commercial outdoor electric lamps"            </span></span>
<span><span class="co">#&gt; [41] "Computers"                                    </span></span>
<span><span class="co">#&gt; [42] "Diesel HDVs"                                  </span></span>
<span><span class="co">#&gt; [43] "Diesel trains"                                </span></span>
<span><span class="co">#&gt; [44] "Domestic aircraft"                            </span></span>
<span><span class="co">#&gt; [45] "Domestic appliances"                          </span></span>
<span><span class="co">#&gt; [46] "Domestic boats"                               </span></span>
<span><span class="co">#&gt; [47] "Domestic electric lamps"                      </span></span>
<span><span class="co">#&gt; [48] "Domestic electric ovens"                      </span></span>
<span><span class="co">#&gt; [49] "Domestic gas ovens"                           </span></span>
<span><span class="co">#&gt; [50] "Electric arc furnaces"                        </span></span>
<span><span class="co">#&gt; [51] "Electric cars"                                </span></span>
<span><span class="co">#&gt; [52] "Electric pumps"                               </span></span>
<span><span class="co">#&gt; [53] "Electric space heaters"                       </span></span>
<span><span class="co">#&gt; [54] "Electric trains"                              </span></span>
<span><span class="co">#&gt; [55] "Electric water heaters"                       </span></span>
<span><span class="co">#&gt; [56] "Electro-chemical processors"                  </span></span>
<span><span class="co">#&gt; [57] "Gas pump jacks"                               </span></span>
<span><span class="co">#&gt; [58] "Gas space heaters"                            </span></span>
<span><span class="co">#&gt; [59] "Gas water heaters"                            </span></span>
<span><span class="co">#&gt; [60] "Gasoline LDVs"                                </span></span>
<span><span class="co">#&gt; [61] "Gasoline motorcycles"                         </span></span>
<span><span class="co">#&gt; [62] "HVAC"                                         </span></span>
<span><span class="co">#&gt; [63] "Industrial electric lamps"                    </span></span>
<span><span class="co">#&gt; [64] "Industrial electric process heaters"          </span></span>
<span><span class="co">#&gt; [65] "Industrial fans"                              </span></span>
<span><span class="co">#&gt; [66] "Industrial refrigerators"                     </span></span>
<span><span class="co">#&gt; [67] "Kerosene stoves"                              </span></span>
<span><span class="co">#&gt; [68] "LPG stoves"                                   </span></span>
<span><span class="co">#&gt; [69] "Machine tools"                                </span></span>
<span><span class="co">#&gt; [70] "Material handlers"                            </span></span>
<span><span class="co">#&gt; [71] "Natural gas vehicles"                         </span></span>
<span><span class="co">#&gt; [72] "Non-energy consumption"                       </span></span>
<span><span class="co">#&gt; [73] "Oil space heaters"                            </span></span>
<span><span class="co">#&gt; [74] "Oil water heaters"                            </span></span>
<span><span class="co">#&gt; [75] "Refrigerators"                                </span></span>
<span><span class="co">#&gt; [76] "Room air conditioners"                        </span></span>
<span><span class="co">#&gt; [77] "Small scale biomass boilers"                  </span></span>
<span><span class="co">#&gt; [78] "Static diesel engines"                        </span></span>
<span><span class="co">#&gt; [79] "Static gasoline engines"                      </span></span>
<span><span class="co">#&gt; [80] "Steam cracking furnaces"                      </span></span>
<span><span class="co">#&gt; [81] "Steam trains"                                 </span></span>
<span><span class="co">#&gt; [82] "Tractors"                                     </span></span>
<span><span class="co">#&gt; [83] "Wood stoves"                                  </span></span>
<span><span class="co">#&gt; [84] "Farms"                                        </span></span>
<span><span class="co">#&gt; [85] "Feed production"                              </span></span>
<span><span class="co">#&gt; [86] "Food production"                              </span></span>
<span><span class="co">#&gt; [87] "Transport not elsewhere specified"            </span></span>
<span><span class="co">#&gt; [88] "Asses"                                        </span></span>
<span><span class="co">#&gt; [89] "Buffaloes"                                    </span></span>
<span><span class="co">#&gt; [90] "Camelids"                                     </span></span>
<span><span class="co">#&gt; [91] "Cattle"                                       </span></span>
<span><span class="co">#&gt; [92] "Horses"                                       </span></span>
<span><span class="co">#&gt; [93] "Human females"                                </span></span>
<span><span class="co">#&gt; [94] "Human males"                                  </span></span>
<span><span class="co">#&gt; [95] "Mules"</span></span></code></pre></div>
<p>The lists of nouns can be used to create aggregation maps, as shown
in the next section.</p>
</div>
<div class="section level2">
<h2 id="construct-an-aggregation-map">Construct an aggregation map<a class="anchor" aria-label="anchor" href="#construct-an-aggregation-map"></a>
</h2>
<p>An aggregation map is a description of the way aggregation is to be
performed. In <code>R</code> terms, an aggregation map is simply a named
list where values are the row or column names (or pieces of names) to be
aggregated and names are the new names for the aggregated rows or
columns.</p>
<p>For example,</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prod_agg_map_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  `Coal &amp; coal products` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hard coal (if no detail)"</span>, </span>
<span>                             <span class="st">"Brown coal (if no detail)"</span>,</span>
<span>                             <span class="st">"Anthracite"</span>,</span>
<span>                             <span class="st">"Coking coal"</span>,</span>
<span>                             <span class="st">"Other bituminous coal"</span>,</span>
<span>                             <span class="st">"Sub-bituminous coal"</span><span class="op">)</span>, </span>
<span>  `Oil &amp; oil products` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Crude/NGL/feedstocks (if no detail)"</span>, </span>
<span>                           <span class="st">"Crude oil"</span>, </span>
<span>                           <span class="st">"Natural gas liquids"</span>, </span>
<span>                           <span class="st">"Refinery feedstocks"</span>, </span>
<span>                           <span class="st">"Additives/blending components"</span>, </span>
<span>                           <span class="st">"Other hydrocarbons"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Aggregation maps can also be constructed from a data frame with
“Many” and “Few” columns.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prod_agg_table_example</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">Many</span>, <span class="op">~</span><span class="va">Few</span>, </span>
<span>  <span class="st">"Hard coal (if no detail)"</span>, <span class="st">"Coal &amp; coal products"</span>,</span>
<span>  <span class="st">"Brown coal (if no detail)"</span>, <span class="st">"Coal &amp; coal products"</span>,</span>
<span>  <span class="st">"Anthracite"</span>, <span class="st">"Coal &amp; coal products"</span>,</span>
<span>  <span class="st">"Coking coal"</span>, <span class="st">"Coal &amp; coal products"</span>,</span>
<span>  <span class="st">"Other bituminous coal"</span>, <span class="st">"Coal &amp; coal products"</span>,</span>
<span>  <span class="st">"Sub-bituminous coal"</span>, <span class="st">"Coal &amp; coal products"</span>,</span>
<span>  <span class="st">"Crude/NGL/feedstocks (if no detail)"</span>, <span class="st">"Oil &amp; oil products"</span>,</span>
<span>  <span class="st">"Crude oil"</span>, <span class="st">"Oil &amp; oil products"</span>,</span>
<span>  <span class="st">"Natural gas liquids"</span>, <span class="st">"Oil &amp; oil products"</span>,</span>
<span>  <span class="st">"Refinery feedstocks"</span>, <span class="st">"Oil &amp; oil products"</span>,</span>
<span>  <span class="st">"Additives/blending components"</span>, <span class="st">"Oil &amp; oil products"</span>,</span>
<span>  <span class="st">"Other hydrocarbons"</span>, <span class="st">"Oil &amp; oil products"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">prod_agg_table_example</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 2</span></span></span>
<span><span class="co">#&gt;    Many                                Few                 </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Hard coal (if no detail)            Coal &amp; coal products</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Brown coal (if no detail)           Coal &amp; coal products</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Anthracite                          Coal &amp; coal products</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Coking coal                         Coal &amp; coal products</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Other bituminous coal               Coal &amp; coal products</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Sub-bituminous coal                 Coal &amp; coal products</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Crude/NGL/feedstocks (if no detail) Oil &amp; oil products  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Crude oil                           Oil &amp; oil products  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Natural gas liquids                 Oil &amp; oil products  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Refinery feedstocks                 Oil &amp; oil products  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> Additives/blending components       Oil &amp; oil products  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> Other hydrocarbons                  Oil &amp; oil products</span></span>
<span></span>
<span><span class="fu">matsbyname</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/aggregation_map_helpers.html" class="external-link">agg_table_to_agg_map</a></span><span class="op">(</span><span class="va">prod_agg_table_example</span>,</span>
<span>                                 many_colname <span class="op">=</span> <span class="st">"Many"</span>, </span>
<span>                                 few_colname <span class="op">=</span> <span class="st">"Few"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`Coal &amp; coal products`</span></span>
<span><span class="co">#&gt; [1] "Hard coal (if no detail)"  "Brown coal (if no detail)"</span></span>
<span><span class="co">#&gt; [3] "Anthracite"                "Coking coal"              </span></span>
<span><span class="co">#&gt; [5] "Other bituminous coal"     "Sub-bituminous coal"      </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Oil &amp; oil products`</span></span>
<span><span class="co">#&gt; [1] "Crude/NGL/feedstocks (if no detail)" "Crude oil"                          </span></span>
<span><span class="co">#&gt; [3] "Natural gas liquids"                 "Refinery feedstocks"                </span></span>
<span><span class="co">#&gt; [5] "Additives/blending components"       "Other hydrocarbons"</span></span></code></pre></div>
<p>Aggregation tables can be created in an Excel file and read into
<code>R</code> with the <code>readxl</code> package. Example aggregation
tables can be found in the “Aggregation_maps.xlsx” file in the
<code>PFUDatabase</code> package.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prod_agg_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Aggregation_Tables.xlsx"</span>,  </span>
<span>                            package<span class="op">=</span><span class="st">"PFUDatabase"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span>sheet <span class="op">=</span> <span class="st">"product_aggregation"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">matsbyname</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/aggregation_map_helpers.html" class="external-link">agg_table_to_agg_map</a></span><span class="op">(</span>many_colname <span class="op">=</span> <span class="st">"Many"</span>, </span>
<span>                                   few_colname <span class="op">=</span> <span class="st">"Few"</span><span class="op">)</span></span>
<span><span class="va">prod_agg_map</span></span>
<span><span class="co">#&gt; $Biofuels</span></span>
<span><span class="co">#&gt; [1] "Primary solid biofuels"                  </span></span>
<span><span class="co">#&gt; [2] "Biogases"                                </span></span>
<span><span class="co">#&gt; [3] "Biogasoline"                             </span></span>
<span><span class="co">#&gt; [4] "Biodiesels"                              </span></span>
<span><span class="co">#&gt; [5] "Bio jet kerosene"                        </span></span>
<span><span class="co">#&gt; [6] "Other liquid biofuels"                   </span></span>
<span><span class="co">#&gt; [7] "Non-specified primary biofuels and waste"</span></span>
<span><span class="co">#&gt; [8] "Charcoal"                                </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Coal &amp; coal products`</span></span>
<span><span class="co">#&gt;  [1] "Hard coal (if no detail)"  "Brown coal (if no detail)"</span></span>
<span><span class="co">#&gt;  [3] "Anthracite"                "Coking coal"              </span></span>
<span><span class="co">#&gt;  [5] "Other bituminous coal"     "Sub-bituminous coal"      </span></span>
<span><span class="co">#&gt;  [7] "Lignite"                   "Patent fuel"              </span></span>
<span><span class="co">#&gt;  [9] "Coke oven coke"            "Gas coke"                 </span></span>
<span><span class="co">#&gt; [11] "Coal tar"                  "BKB"                      </span></span>
<span><span class="co">#&gt; [13] "Gas works gas"             "Coke oven gas"            </span></span>
<span><span class="co">#&gt; [15] "Blast furnace gas"         "Other recovered gases"    </span></span>
<span><span class="co">#&gt; [17] "Peat"                      "Peat products"            </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Electricity</span></span>
<span><span class="co">#&gt; [1] "Nuclear"              "Hydro"                "Solar photovoltaics" </span></span>
<span><span class="co">#&gt; [4] "Tide, wave and ocean" "Wind"                 "Other sources"       </span></span>
<span><span class="co">#&gt; [7] "Electricity"         </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Feed</span></span>
<span><span class="co">#&gt; [1] "Feed"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Food</span></span>
<span><span class="co">#&gt; [1] "Food"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $HPF</span></span>
<span><span class="co">#&gt; [1] "HPA"  "HPL"  "HPNG"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $HTH</span></span>
<span><span class="co">#&gt; [1] "HTH.1000.C" "HTH.1300.C" "HTH.1600.C" "HTH.400.C"  "HTH.600.C" </span></span>
<span><span class="co">#&gt; [6] "HTH.850.C"  "HTH.960.C" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Heat</span></span>
<span><span class="co">#&gt; [1] "Elec/heat output from non-specified manufactured gases"</span></span>
<span><span class="co">#&gt; [2] "Heat output from non-specified combustible fuels"      </span></span>
<span><span class="co">#&gt; [3] "Geothermal"                                            </span></span>
<span><span class="co">#&gt; [4] "Solar thermal"                                         </span></span>
<span><span class="co">#&gt; [5] "Heat"                                                  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $IP</span></span>
<span><span class="co">#&gt; [1] "IP"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $L</span></span>
<span><span class="co">#&gt; [1] "L"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $LTC</span></span>
<span><span class="co">#&gt; [1] "LTC.-10.C" "LTC.20.C" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $LTH</span></span>
<span><span class="co">#&gt; [1] "LTH.20.C" "LTH.50.C" "LTH.60.C"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $MTH</span></span>
<span><span class="co">#&gt; [1] "MTH.100.C" "MTH.200.C" "MTH.300.C"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $MechW</span></span>
<span><span class="co">#&gt; [1] "KE"   "MD"   "MF"   "MacW"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $MuscW</span></span>
<span><span class="co">#&gt; [1] "AMW" "HMW"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $NEU</span></span>
<span><span class="co">#&gt; [1] "NEU"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Natural gas`</span></span>
<span><span class="co">#&gt; [1] "Natural gas"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Oil &amp; oil products`</span></span>
<span><span class="co">#&gt;  [1] "Oil shale and oil sands"              </span></span>
<span><span class="co">#&gt;  [2] "Crude/NGL/feedstocks (if no detail)"  </span></span>
<span><span class="co">#&gt;  [3] "Crude oil"                            </span></span>
<span><span class="co">#&gt;  [4] "Natural gas liquids"                  </span></span>
<span><span class="co">#&gt;  [5] "Refinery feedstocks\""                </span></span>
<span><span class="co">#&gt;  [6] "Additives/blending components"        </span></span>
<span><span class="co">#&gt;  [7] "Other hydrocarbons"                   </span></span>
<span><span class="co">#&gt;  [8] "Refinery gas"                         </span></span>
<span><span class="co">#&gt;  [9] "Ethane"                               </span></span>
<span><span class="co">#&gt; [10] "Liquefied petroleum gases (LPG)"      </span></span>
<span><span class="co">#&gt; [11] "Motor gasoline excl. biofuels"        </span></span>
<span><span class="co">#&gt; [12] "Aviation gasoline"                    </span></span>
<span><span class="co">#&gt; [13] "Gasoline type jet fuel"               </span></span>
<span><span class="co">#&gt; [14] "Kerosene type jet fuel excl. biofuels"</span></span>
<span><span class="co">#&gt; [15] "Other kerosene"                       </span></span>
<span><span class="co">#&gt; [16] "Gas/diesel oil excl. biofuels"        </span></span>
<span><span class="co">#&gt; [17] "Fuel oil"                             </span></span>
<span><span class="co">#&gt; [18] "Naphtha"                              </span></span>
<span><span class="co">#&gt; [19] "White spirit &amp; SBP"                   </span></span>
<span><span class="co">#&gt; [20] "Lubricants"                           </span></span>
<span><span class="co">#&gt; [21] "Bitumen"                              </span></span>
<span><span class="co">#&gt; [22] "Paraffin waxes"                       </span></span>
<span><span class="co">#&gt; [23] "Petroleum coke"                       </span></span>
<span><span class="co">#&gt; [24] "Other oil products"                   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Prop</span></span>
<span><span class="co">#&gt; [1] "AirP" "MaP"  "RaP"  "RoP" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Waste</span></span>
<span><span class="co">#&gt; [1] "Industrial waste"                "Municipal waste (renewable)"    </span></span>
<span><span class="co">#&gt; [3] "Municipal waste (non-renewable)"</span></span>
<span></span>
<span><span class="va">ind_agg_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Aggregation_Tables.xlsx"</span>, </span>
<span>                              package<span class="op">=</span><span class="st">"PFUDatabase"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span>sheet <span class="op">=</span> <span class="st">"industry_aggregation"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">matsbyname</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/aggregation_map_helpers.html" class="external-link">agg_table_to_agg_map</a></span><span class="op">(</span>many_colname <span class="op">=</span> <span class="st">"Many"</span>, </span>
<span>                                   few_colname <span class="op">=</span> <span class="st">"Few"</span><span class="op">)</span></span>
<span><span class="va">ind_agg_map</span></span>
<span><span class="co">#&gt; $`Agriculture, forestry, and fishing`</span></span>
<span><span class="co">#&gt; [1] "Agriculture/forestry" "Fishing"             </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Commercial and public services`</span></span>
<span><span class="co">#&gt; [1] "Commercial and public services"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Energy industry own use`</span></span>
<span><span class="co">#&gt;  [1] "Coal mines"                                 </span></span>
<span><span class="co">#&gt;  [2] "Oil and gas extraction"                     </span></span>
<span><span class="co">#&gt;  [3] "Blast furnaces"                             </span></span>
<span><span class="co">#&gt;  [4] "Gas works"                                  </span></span>
<span><span class="co">#&gt;  [5] "Gasification plants for biogases"           </span></span>
<span><span class="co">#&gt;  [6] "Coke ovens"                                 </span></span>
<span><span class="co">#&gt;  [7] "Patent fuel plants"                         </span></span>
<span><span class="co">#&gt;  [8] "BKB/peat briquette plants"                  </span></span>
<span><span class="co">#&gt;  [9] "Oil refineries"                             </span></span>
<span><span class="co">#&gt; [10] "Coal liquefaction plants"                   </span></span>
<span><span class="co">#&gt; [11] "Liquefaction (LNG) / regasification plants" </span></span>
<span><span class="co">#&gt; [12] "Gas-to-liquids (GTL) plants"                </span></span>
<span><span class="co">#&gt; [13] "Own use in electricity, CHP and heat plants"</span></span>
<span><span class="co">#&gt; [14] "Pumped storage plants"                      </span></span>
<span><span class="co">#&gt; [15] "Nuclear industry"                           </span></span>
<span><span class="co">#&gt; [16] "Charcoal production plants"                 </span></span>
<span><span class="co">#&gt; [17] "Non-specified (energy)"                     </span></span>
<span><span class="co">#&gt; [18] "Main activity producer electricity plants"  </span></span>
<span><span class="co">#&gt; [19] "Main activity producer CHP plants"          </span></span>
<span><span class="co">#&gt; [20] "Main activity producer heat plants"         </span></span>
<span><span class="co">#&gt; [21] "Manufacture"                                </span></span>
<span><span class="co">#&gt; [22] "Natural gas extraction"                     </span></span>
<span><span class="co">#&gt; [23] "Oil extraction"                             </span></span>
<span><span class="co">#&gt; [24] "Transfers"                                  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Industry</span></span>
<span><span class="co">#&gt;  [1] "Mining and quarrying"             "Construction"                    </span></span>
<span><span class="co">#&gt;  [3] "Iron and steel"                   "Chemical and petrochemical"      </span></span>
<span><span class="co">#&gt;  [5] "Non-ferrous metals"               "Non-metallic minerals"           </span></span>
<span><span class="co">#&gt;  [7] "Transport equipment"              "Machinery"                       </span></span>
<span><span class="co">#&gt;  [9] "Food and tobacco"                 "Paper, pulp and printing"        </span></span>
<span><span class="co">#&gt; [11] "Wood and wood products"           "Textile and leather"             </span></span>
<span><span class="co">#&gt; [13] "Industry not elsewhere specified"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Manufacture</span></span>
<span><span class="co">#&gt; [1] "Manufacture"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Non-energy use`</span></span>
<span><span class="co">#&gt;  [1] "Non-energy use industry/transformation/energy"     </span></span>
<span><span class="co">#&gt;  [2] "Non-energy use in transport"                       </span></span>
<span><span class="co">#&gt;  [3] "Non-energy use in other"                           </span></span>
<span><span class="co">#&gt;  [4] "Non-energy use in construction"                    </span></span>
<span><span class="co">#&gt;  [5] "Non-energy use in mining and quarrying"            </span></span>
<span><span class="co">#&gt;  [6] "Non-energy use in iron and steel"                  </span></span>
<span><span class="co">#&gt;  [7] "Non-energy use in chemical/petrochemical"          </span></span>
<span><span class="co">#&gt;  [8] "Non-energy use in non-ferrous metals"              </span></span>
<span><span class="co">#&gt;  [9] "Non-energy use in non-metallic minerals"           </span></span>
<span><span class="co">#&gt; [10] "Non-energy use in transport equipment"             </span></span>
<span><span class="co">#&gt; [11] "Non-energy use in machinery"                       </span></span>
<span><span class="co">#&gt; [12] "Non-energy use in food/beverages/tobacco"          </span></span>
<span><span class="co">#&gt; [13] "Non-energy use in paper/pulp and printing"         </span></span>
<span><span class="co">#&gt; [14] "Non-energy use in wood and wood products"          </span></span>
<span><span class="co">#&gt; [15] "Non-energy use in textiles and leather"            </span></span>
<span><span class="co">#&gt; [16] "Non-energy use in industry not elsewhere specified"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Residential</span></span>
<span><span class="co">#&gt; [1] "Residential"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Transport</span></span>
<span><span class="co">#&gt;  [1] "World aviation bunkers"            "Domestic aviation"                </span></span>
<span><span class="co">#&gt;  [3] "Road"                              "Rail"                             </span></span>
<span><span class="co">#&gt;  [5] "Pipeline transport"                "World marine bunkers"             </span></span>
<span><span class="co">#&gt;  [7] "Exports to World marine bunkers"   "Domestic navigation"              </span></span>
<span><span class="co">#&gt;  [9] "Transport not elsewhere specified" "International aviation"           </span></span>
<span><span class="co">#&gt; [11] "International navigation"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="perform-the-aggregations">Perform the aggregations<a class="anchor" aria-label="anchor" href="#perform-the-aggregations"></a>
</h2>
<p>There are two <code>matsbyname</code> functions that assist with
aggregations: <code><a href="https://rdrr.io/pkg/matsbyname/man/aggregate_byname.html" class="external-link">matsbyname::aggregate_byname()</a></code> and
<code><a href="https://rdrr.io/pkg/matsbyname/man/aggregate_pieces_byname.html" class="external-link">matsbyname::aggregate_pieces_byname()</a></code>. A third function
(<code><a href="https://rdrr.io/pkg/matsbyname/man/aggregate_to_pref_suff_byname.html" class="external-link">matsbyname::aggregate_to_pref_suff_byname()</a></code>) has been
deprecated in favor of
<code><a href="https://rdrr.io/pkg/matsbyname/man/aggregate_pieces_byname.html" class="external-link">matsbyname::aggregate_pieces_byname()</a></code>.</p>
<p>Knowing that the <code>matsbyname</code> package can aggregate by any
piece of a row or column label (including prefix, suffix, noun, or
object of a preposition), aggregation maps can be constructed by
focusing only on the nouns (prefixes) of the row and column names.</p>
<p>To aggregate the matrices in the <code>df</code> object, one can use
code like the following example.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aggregated</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># Restrict to a single year to reduce execution time.</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Year</span> <span class="op">==</span> <span class="fl">1960</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Aggregate R</span></span>
<span>    R_agg <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="st">"R"</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">matsbyname</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/aggregate_pieces_byname.html" class="external-link">aggregate_pieces_byname</a></span><span class="op">(</span></span>
<span>        piece <span class="op">=</span> <span class="st">"noun"</span>,</span>
<span>        margin <span class="op">=</span> <span class="st">"Industry"</span>,</span>
<span>        inf_notation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        notation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/bracket_notation.html" class="external-link">bracket_notation</a></span>, <span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/arrow_notation.html" class="external-link">arrow_notation</a></span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">matsbyname</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/aggregate_pieces_byname.html" class="external-link">aggregate_pieces_byname</a></span><span class="op">(</span></span>
<span>        piece <span class="op">=</span> <span class="st">"noun"</span>,</span>
<span>        margin <span class="op">=</span> <span class="st">"Product"</span>,</span>
<span>        inf_notation <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        notation <span class="op">=</span> <span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/bracket_notation.html" class="external-link">bracket_notation</a></span>,</span>
<span>        aggregation_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">prod_agg_map</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>    <span class="co"># Aggregate U_feed</span></span>
<span>    U_feed_agg <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="st">"U_feed"</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">matsbyname</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/aggregate_pieces_byname.html" class="external-link">aggregate_pieces_byname</a></span><span class="op">(</span></span>
<span>        piece <span class="op">=</span> <span class="st">"noun"</span>,</span>
<span>        margin <span class="op">=</span> <span class="st">"Product"</span>,</span>
<span>        inf_notation <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        notation <span class="op">=</span> <span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/bracket_notation.html" class="external-link">bracket_notation</a></span>,</span>
<span>        aggregation_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">prod_agg_map</span><span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">matsbyname</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/aggregate_pieces_byname.html" class="external-link">aggregate_pieces_byname</a></span><span class="op">(</span></span>
<span>        piece <span class="op">=</span> <span class="st">"noun"</span>,</span>
<span>        margin <span class="op">=</span> <span class="st">"Industry"</span>,</span>
<span>        inf_notation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        notation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/bracket_notation.html" class="external-link">bracket_notation</a></span>, <span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/arrow_notation.html" class="external-link">arrow_notation</a></span><span class="op">)</span><span class="op">)</span>,</span>
<span>        aggregation_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ind_agg_map</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>    <span class="co"># Aggregate U_EIOU</span></span>
<span>    U_EIOU_agg <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="st">"U_EIOU"</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">matsbyname</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/aggregate_pieces_byname.html" class="external-link">aggregate_pieces_byname</a></span><span class="op">(</span></span>
<span>        piece <span class="op">=</span> <span class="st">"noun"</span>,</span>
<span>        margin <span class="op">=</span> <span class="st">"Product"</span>,</span>
<span>        inf_notation <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        notation <span class="op">=</span> <span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/bracket_notation.html" class="external-link">bracket_notation</a></span>,</span>
<span>        aggregation_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">prod_agg_map</span><span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">matsbyname</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/aggregate_pieces_byname.html" class="external-link">aggregate_pieces_byname</a></span><span class="op">(</span></span>
<span>        piece <span class="op">=</span> <span class="st">"noun"</span>,</span>
<span>        margin <span class="op">=</span> <span class="st">"Industry"</span>,</span>
<span>        inf_notation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        notation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/bracket_notation.html" class="external-link">bracket_notation</a></span>, <span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/arrow_notation.html" class="external-link">arrow_notation</a></span><span class="op">)</span><span class="op">)</span>,</span>
<span>        aggregation_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ind_agg_map</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>    <span class="co"># Create aggregated U matrix</span></span>
<span>    U_agg <span class="op">=</span> <span class="fu">matsbyname</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/sum_byname.html" class="external-link">sum_byname</a></span><span class="op">(</span><span class="va">.data</span><span class="op">[[</span><span class="st">"U_feed_agg"</span><span class="op">]</span><span class="op">]</span>, <span class="va">.data</span><span class="op">[[</span><span class="st">"U_EIOU_agg"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    <span class="co"># Create aggregated r_EIOU matrix</span></span>
<span>    r_EIOU_agg <span class="op">=</span> <span class="fu">matsbyname</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/quotient_byname.html" class="external-link">quotient_byname</a></span><span class="op">(</span><span class="va">.data</span><span class="op">[[</span><span class="st">"U_EIOU"</span><span class="op">]</span><span class="op">]</span>, <span class="va">.data</span><span class="op">[[</span><span class="st">"U"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">matsbyname</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/replaceNaN_byname.html" class="external-link">replaceNaN_byname</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="co"># Aggregate V</span></span>
<span>    V_agg <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="st">"V"</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">matsbyname</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/aggregate_pieces_byname.html" class="external-link">aggregate_pieces_byname</a></span><span class="op">(</span></span>
<span>        piece <span class="op">=</span> <span class="st">"noun"</span>,</span>
<span>        margin <span class="op">=</span> <span class="st">"Industry"</span>,</span>
<span>        inf_notation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        notation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/bracket_notation.html" class="external-link">bracket_notation</a></span>, <span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/arrow_notation.html" class="external-link">arrow_notation</a></span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">matsbyname</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/aggregate_pieces_byname.html" class="external-link">aggregate_pieces_byname</a></span><span class="op">(</span></span>
<span>        piece <span class="op">=</span> <span class="st">"noun"</span>,</span>
<span>        margin <span class="op">=</span> <span class="st">"Product"</span>,</span>
<span>        inf_notation <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        notation <span class="op">=</span> <span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/bracket_notation.html" class="external-link">bracket_notation</a></span>,</span>
<span>        aggregation_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">prod_agg_map</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>    <span class="co"># Aggregate Y</span></span>
<span>    Y_agg <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="st">"Y"</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">matsbyname</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/aggregate_pieces_byname.html" class="external-link">aggregate_pieces_byname</a></span><span class="op">(</span></span>
<span>        piece <span class="op">=</span> <span class="st">"noun"</span>,</span>
<span>        margin <span class="op">=</span> <span class="st">"Product"</span>,</span>
<span>        inf_notation <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        notation <span class="op">=</span> <span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/bracket_notation.html" class="external-link">bracket_notation</a></span>,</span>
<span>        aggregation_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">prod_agg_map</span><span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">matsbyname</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/aggregate_pieces_byname.html" class="external-link">aggregate_pieces_byname</a></span><span class="op">(</span></span>
<span>        piece <span class="op">=</span> <span class="st">"noun"</span>,</span>
<span>        margin <span class="op">=</span> <span class="st">"Industry"</span>,</span>
<span>        inf_notation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        notation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/bracket_notation.html" class="external-link">bracket_notation</a></span>, <span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/arrow_notation.html" class="external-link">arrow_notation</a></span><span class="op">)</span><span class="op">)</span>,</span>
<span>        aggregation_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ind_agg_map</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>The aggregated matrices are simpler than the original matrices, as
expected.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aggregated</span><span class="op">$</span><span class="va">R_agg</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                         Biofuels Coal &amp; coal products Electricity Heat</span></span>
<span><span class="co">#&gt; Imports                        0                  225         458    0</span></span>
<span><span class="co">#&gt; Resources                  32367               243640       12823   30</span></span>
<span><span class="co">#&gt; Statistical differences        1                 6571           0    0</span></span>
<span><span class="co">#&gt; Stock changes                  0                  771           0    0</span></span>
<span><span class="co">#&gt;                         Natural gas Oil &amp; oil products</span></span>
<span><span class="co">#&gt; Imports                        3656              93392</span></span>
<span><span class="co">#&gt; Resources                    283514             392570</span></span>
<span><span class="co">#&gt; Statistical differences           1               7046</span></span>
<span><span class="co">#&gt; Stock changes                     0               5999</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span></span>
<span><span class="va">aggregated</span><span class="op">$</span><span class="va">U_feed_agg</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                      Energy industry own use</span></span>
<span><span class="co">#&gt; Biofuels                               32388</span></span>
<span><span class="co">#&gt; Coal &amp; coal products                  433824</span></span>
<span><span class="co">#&gt; Electricity                            25646</span></span>
<span><span class="co">#&gt; Heat                                      60</span></span>
<span><span class="co">#&gt; Natural gas                           327540</span></span>
<span><span class="co">#&gt; Oil &amp; oil products                    855297</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span>
<span></span>
<span><span class="va">aggregated</span><span class="op">$</span><span class="va">U_EIOU_agg</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                      Energy industry own use</span></span>
<span><span class="co">#&gt; Coal &amp; coal products                    6473</span></span>
<span><span class="co">#&gt; Electricity                             3756</span></span>
<span><span class="co">#&gt; Natural gas                            37137</span></span>
<span><span class="co">#&gt; Oil &amp; oil products                     35612</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span>
<span></span>
<span><span class="va">aggregated</span><span class="op">$</span><span class="va">U_agg</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                      Energy industry own use</span></span>
<span><span class="co">#&gt; Biofuels                               32388</span></span>
<span><span class="co">#&gt; Coal &amp; coal products                  440297</span></span>
<span><span class="co">#&gt; Electricity                            29402</span></span>
<span><span class="co">#&gt; Heat                                      60</span></span>
<span><span class="co">#&gt; Natural gas                           364677</span></span>
<span><span class="co">#&gt; Oil &amp; oil products                    890909</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span>
<span></span>
<span><span class="va">aggregated</span><span class="op">$</span><span class="va">V_agg</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                                           Biofuels Coal &amp; coal products</span></span>
<span><span class="co">#&gt; Blast furnaces                                   0                 9500</span></span>
<span><span class="co">#&gt; Coal mines                                       0               243640</span></span>
<span><span class="co">#&gt; Coke ovens                                       0                46862</span></span>
<span><span class="co">#&gt; Gas works                                        0                 4365</span></span>
<span><span class="co">#&gt; Main activity producer electricity plants        0                    0</span></span>
<span><span class="co">#&gt; Manufacture                                  32367                    0</span></span>
<span><span class="co">#&gt; Natural gas extraction                           0                    0</span></span>
<span><span class="co">#&gt; Nuclear industry                                 0                    0</span></span>
<span><span class="co">#&gt; Oil extraction                                   0                    0</span></span>
<span><span class="co">#&gt; Oil refineries                                   0                    0</span></span>
<span><span class="co">#&gt; Patent fuel plants                               0                  489</span></span>
<span><span class="co">#&gt; Transfers                                        0                    0</span></span>
<span><span class="co">#&gt;                                           Electricity Heat Natural gas</span></span>
<span><span class="co">#&gt; Blast furnaces                                   0.00    0           0</span></span>
<span><span class="co">#&gt; Coal mines                                       0.00    0           0</span></span>
<span><span class="co">#&gt; Coke ovens                                       0.00    0           0</span></span>
<span><span class="co">#&gt; Gas works                                        0.00    0           0</span></span>
<span><span class="co">#&gt; Main activity producer electricity plants    68712.48    0           0</span></span>
<span><span class="co">#&gt; Manufacture                                  12823.00   30           0</span></span>
<span><span class="co">#&gt; Natural gas extraction                           0.00    0      283514</span></span>
<span><span class="co">#&gt; Nuclear industry                                47.52    0           0</span></span>
<span><span class="co">#&gt; Oil extraction                                   0.00    0           0</span></span>
<span><span class="co">#&gt; Oil refineries                                   0.00    0           0</span></span>
<span><span class="co">#&gt; Patent fuel plants                               0.00    0           0</span></span>
<span><span class="co">#&gt; Transfers                                        0.00    0           0</span></span>
<span><span class="co">#&gt;                                           Oil &amp; oil products</span></span>
<span><span class="co">#&gt; Blast furnaces                                             0</span></span>
<span><span class="co">#&gt; Coal mines                                                 0</span></span>
<span><span class="co">#&gt; Coke ovens                                                 0</span></span>
<span><span class="co">#&gt; Gas works                                                  0</span></span>
<span><span class="co">#&gt; Main activity producer electricity plants                  0</span></span>
<span><span class="co">#&gt; Manufacture                                                0</span></span>
<span><span class="co">#&gt; Natural gas extraction                                     0</span></span>
<span><span class="co">#&gt; Nuclear industry                                           0</span></span>
<span><span class="co">#&gt; Oil extraction                                        392570</span></span>
<span><span class="co">#&gt; Oil refineries                                        439718</span></span>
<span><span class="co">#&gt; Patent fuel plants                                         0</span></span>
<span><span class="co">#&gt; Transfers                                              15901</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span></span>
<span><span class="va">aggregated</span><span class="op">$</span><span class="va">Y_agg</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                      Agriculture, forestry, and fishing</span></span>
<span><span class="co">#&gt; Biofuels                                              0</span></span>
<span><span class="co">#&gt; Coal &amp; coal products                                  0</span></span>
<span><span class="co">#&gt; Electricity                                        2517</span></span>
<span><span class="co">#&gt; Natural gas                                           0</span></span>
<span><span class="co">#&gt; Oil &amp; oil products                                 8250</span></span>
<span><span class="co">#&gt;                      Commercial and public services Exports</span></span>
<span><span class="co">#&gt; Biofuels                                          0       0</span></span>
<span><span class="co">#&gt; Coal &amp; coal products                          13883   21586</span></span>
<span><span class="co">#&gt; Electricity                                   11032      68</span></span>
<span><span class="co">#&gt; Natural gas                                   23955     265</span></span>
<span><span class="co">#&gt; Oil &amp; oil products                            27606   10063</span></span>
<span><span class="co">#&gt;                      Exports to World aviation bunkers</span></span>
<span><span class="co">#&gt; Biofuels                                             0</span></span>
<span><span class="co">#&gt; Coal &amp; coal products                                 0</span></span>
<span><span class="co">#&gt; Electricity                                          0</span></span>
<span><span class="co">#&gt; Natural gas                                          0</span></span>
<span><span class="co">#&gt; Oil &amp; oil products                                1895</span></span>
<span><span class="co">#&gt;                      Final consumption not elsewhere specified Industry Losses</span></span>
<span><span class="co">#&gt; Biofuels                                                 15666    16681      0</span></span>
<span><span class="co">#&gt; Coal &amp; coal products                                         0    65298      0</span></span>
<span><span class="co">#&gt; Electricity                                                  0    27859   6237</span></span>
<span><span class="co">#&gt; Natural gas                                                  0    94743  11090</span></span>
<span><span class="co">#&gt; Oil &amp; oil products                                        9886    74409      0</span></span>
<span><span class="co">#&gt;                      Non-energy use Residential Statistical differences</span></span>
<span><span class="co">#&gt; Biofuels                          0           0                       0</span></span>
<span><span class="co">#&gt; Coal &amp; coal products              0       11960                    1530</span></span>
<span><span class="co">#&gt; Electricity                       0       17283                       0</span></span>
<span><span class="co">#&gt; Natural gas                       0       72862                       0</span></span>
<span><span class="co">#&gt; Oil &amp; oil products            40462       45566                       4</span></span>
<span><span class="co">#&gt;                      Stock changes Transport</span></span>
<span><span class="co">#&gt; Biofuels                         0         0</span></span>
<span><span class="co">#&gt; Coal &amp; coal products            33      1476</span></span>
<span><span class="co">#&gt; Electricity                      0       466</span></span>
<span><span class="co">#&gt; Natural gas                   3093         0</span></span>
<span><span class="co">#&gt; Oil &amp; oil products            1618    236528</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>Through judicious use of several helpful functions
(<code><a href="https://matthewheun.github.io/Recca/reference/get_all_products_and_industries.html" class="external-link">Recca::get_all_products_and_industries()</a></code>,
<code><a href="https://rdrr.io/pkg/matsbyname/man/aggregation_map_helpers.html" class="external-link">matsbyname::agg_table_to_agg_map()</a></code>, and
<code><a href="https://rdrr.io/pkg/matsbyname/man/aggregate_pieces_byname.html" class="external-link">matsbyname::aggregate_pieces_byname()</a></code>), one can aggregate
PSUT matrices when they are arranged in a matsindf data frame.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matthew Heun, Emmanuel Aramendia, Zeke Marshall.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
